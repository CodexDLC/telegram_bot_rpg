ðŸ› ï¸ Ð¢ÐµÑ…Ð½Ð¸Ñ‡ÐµÑÐºÐ°Ñ Ð¡Ð¿ÐµÑ†Ð¸Ñ„Ð¸ÐºÐ°Ñ†Ð¸Ñ: ÐÐ´Ð¼Ð¸Ð½-Ð¿Ð°Ð½ÐµÐ»ÑŒ Ð¸ Ð˜Ð½ÑÑ‚Ñ€ÑƒÐ¼ÐµÐ½Ñ‚Ñ‹ Ð¢ÐµÑÑ‚Ð¸Ñ€Ð¾Ð²Ñ‰Ð¸ÐºÐ°
Ð¡Ñ‚Ð°Ñ‚ÑƒÑ: Draft Ð¦ÐµÐ»ÑŒ: Ð ÐµÐ°Ð»Ð¸Ð·Ð¾Ð²Ð°Ñ‚ÑŒ Ð²Ð½ÑƒÑ‚Ñ€Ð¸Ð¸Ð³Ñ€Ð¾Ð²Ð¾Ð¹ Ð¸Ð½Ñ‚ÐµÑ€Ñ„ÐµÐ¹Ñ Ð´Ð»Ñ ÑƒÐ¿Ñ€Ð°Ð²Ð»ÐµÐ½Ð¸Ñ ÑÐ¾ÑÑ‚Ð¾ÑÐ½Ð¸ÐµÐ¼ Ð¸Ð³Ñ€Ñ‹, Ð²Ñ‹Ð´Ð°Ñ‡Ð¸ Ð¿Ñ€ÐµÐ´Ð¼ÐµÑ‚Ð¾Ð² Ð¸ Ð¾Ñ‚Ð»Ð°Ð´ÐºÐ¸ Ð¼ÐµÑ…Ð°Ð½Ð¸Ðº Ð±ÐµÐ· Ð¿Ñ€ÑÐ¼Ð¾Ð³Ð¾ Ð´Ð¾ÑÑ‚ÑƒÐ¿Ð° Ðº Ð‘Ð”.

1. ÐÑ€Ñ…Ð¸Ñ‚ÐµÐºÑ‚ÑƒÑ€Ð° Ð¸ Ð‘ÐµÐ·Ð¾Ð¿Ð°ÑÐ½Ð¾ÑÑ‚ÑŒ
ÐšÐ¾Ð½Ñ‚Ñ€Ð¾Ð»ÑŒ Ð”Ð¾ÑÑ‚ÑƒÐ¿Ð°
ÐÐ´Ð¼Ð¸Ð½-Ð¿Ð°Ð½ÐµÐ»ÑŒ Ð½Ðµ Ð´Ð¾Ð»Ð¶Ð½Ð° Ð±Ñ‹Ñ‚ÑŒ Ð´Ð¾ÑÑ‚ÑƒÐ¿Ð½Ð° Ð¾Ð±Ñ‹Ñ‡Ð½Ñ‹Ð¼ Ð¸Ð³Ñ€Ð¾ÐºÐ°Ð¼.

ÐŸÐµÑ€ÐµÐ¼ÐµÐ½Ð½Ð°Ñ Ð¾ÐºÑ€ÑƒÐ¶ÐµÐ½Ð¸Ñ: Ð’ .env Ð´Ð¾Ð±Ð°Ð²Ð»ÑÐµÑ‚ÑÑ ÑÐ¿Ð¸ÑÐ¾Ðº ADMIN_IDS (Ñ‡ÐµÑ€ÐµÐ· Ð·Ð°Ð¿ÑÑ‚ÑƒÑŽ).

Ð¤Ñ€Ð°Ð³Ð¼ÐµÐ½Ñ‚ ÐºÐ¾Ð´Ð°

ADMIN_IDS=12345678,87654321
Ð¤Ð¸Ð»ÑŒÑ‚Ñ€ (AdminFilter): ÐšÐ°ÑÑ‚Ð¾Ð¼Ð½Ñ‹Ð¹ Ñ„Ð¸Ð»ÑŒÑ‚Ñ€ Aiogram, ÐºÐ¾Ñ‚Ð¾Ñ€Ñ‹Ð¹ Ð¿Ñ€Ð¾Ð²ÐµÑ€ÑÐµÑ‚ user_id Ð½Ð° Ð²Ñ…Ð¾Ð¶Ð´ÐµÐ½Ð¸Ðµ Ð² ÑÑ‚Ð¾Ñ‚ ÑÐ¿Ð¸ÑÐ¾Ðº. Ð˜ÑÐ¿Ð¾Ð»ÑŒÐ·ÑƒÐµÑ‚ÑÑ Ð½Ð° Ñ€Ð¾ÑƒÑ‚ÐµÑ€Ðµ admin_router.

FSM: AdminMode
Ð¡Ð¾Ð·Ð´Ð°ÐµÑ‚ÑÑ Ð¾Ñ‚Ð´ÐµÐ»ÑŒÐ½Ð°Ñ Ð³Ñ€ÑƒÐ¿Ð¿Ð° ÑÐ¾ÑÑ‚Ð¾ÑÐ½Ð¸Ð¹ Ð´Ð»Ñ Ð¸Ð·Ð¾Ð»ÑÑ†Ð¸Ð¸ Ð°Ð´Ð¼Ð¸Ð½Ð° Ð¾Ñ‚ Ð¸Ð³Ñ€Ð¾Ð²Ð¾Ð¹ Ð»Ð¾Ð³Ð¸ÐºÐ¸.

Python

# app/resources/fsm_states/states.py
class AdminMode(StatesGroup):
    menu = State()          # Ð“Ð»Ð°Ð²Ð½Ð¾Ðµ Ð¼ÐµÐ½ÑŽ Ð°Ð´Ð¼Ð¸Ð½ÐºÐ¸
    item_add = State()      # Ð’Ð²Ð¾Ð´ ID/Ð½Ð°Ð·Ð²Ð°Ð½Ð¸Ñ Ð¿Ñ€ÐµÐ´Ð¼ÐµÑ‚Ð° Ð´Ð»Ñ Ð²Ñ‹Ð´Ð°Ñ‡Ð¸
    currency_add = State()  # Ð’Ð²Ð¾Ð´ ÐºÐ¾Ð»Ð¸Ñ‡ÐµÑÑ‚Ð²Ð° Ð²Ð°Ð»ÑŽÑ‚Ñ‹
    teleport = State()      # Ð’Ñ‹Ð±Ð¾Ñ€ Ð»Ð¾ÐºÐ°Ñ†Ð¸Ð¸ Ð´Ð»Ñ Ñ‚ÐµÐ»ÐµÐ¿Ð¾Ñ€Ñ‚Ð°
2. Ð¤ÑƒÐ½ÐºÑ†Ð¸Ð¾Ð½Ð°Ð» (MVP)
Ð¢Ð¾Ñ‡ÐºÐ° Ð²Ñ…Ð¾Ð´Ð°
ÐšÐ¾Ð¼Ð°Ð½Ð´Ð°: /admin (Ð¸Ð»Ð¸ /gm).

Ð£ÑÐ»Ð¾Ð²Ð¸Ðµ: User ID Ð² ADMIN_IDS.

Ð”ÐµÐ¹ÑÑ‚Ð²Ð¸Ðµ:

Ð‘Ð¾Ñ‚ Ð¿Ñ€Ð¾Ð²ÐµÑ€ÑÐµÑ‚ Ð¿Ñ€Ð°Ð²Ð°.

Ð¡Ð±Ñ€Ð°ÑÑ‹Ð²Ð°ÐµÑ‚ Ñ‚ÐµÐºÑƒÑ‰Ð¸Ð¹ ÑÑ‚ÐµÐ¹Ñ‚ (state.clear()).

Ð¡Ñ‚Ð°Ð²Ð¸Ñ‚ ÑÑ‚ÐµÐ¹Ñ‚ AdminMode.menu.

ÐžÑ‚Ð¿Ñ€Ð°Ð²Ð»ÑÐµÑ‚ ÑÐ¾Ð¾Ð±Ñ‰ÐµÐ½Ð¸Ðµ "ÐŸÐ°Ð½ÐµÐ»ÑŒ ÑƒÐ¿Ñ€Ð°Ð²Ð»ÐµÐ½Ð¸Ñ" Ñ ÐºÐ½Ð¾Ð¿ÐºÐ°Ð¼Ð¸.

Ð’Ð¾Ð·Ð¼Ð¾Ð¶Ð½Ð¾ÑÑ‚Ð¸ (ÐšÐ½Ð¾Ð¿ÐºÐ¸)
1. ðŸ“¦ Ð’Ñ‹Ð´Ð°Ñ‡Ð° ÐŸÑ€ÐµÐ´Ð¼ÐµÑ‚Ð¾Ð² (Give Item)
Ð›Ð¾Ð³Ð¸ÐºÐ°:

ÐÐ´Ð¼Ð¸Ð½ Ð²Ñ‹Ð±Ð¸Ñ€Ð°ÐµÑ‚ ÐºÐ°Ñ‚ÐµÐ³Ð¾Ñ€Ð¸ÑŽ (Weapon/Armor).

Ð‘Ð¾Ñ‚ Ð¿Ñ€Ð¸ÑÑ‹Ð»Ð°ÐµÑ‚ ÑÐ¿Ð¸ÑÐ¾Ðº ÑˆÐ°Ð±Ð»Ð¾Ð½Ð¾Ð² (ÐºÐ»ÑŽÑ‡Ð¸ Ð¸Ð· BASE_ITEM_TEMPLATES).

ÐÐ´Ð¼Ð¸Ð½ Ð½Ð°Ð¶Ð¸Ð¼Ð°ÐµÑ‚ Ð½Ð° ÑˆÐ°Ð±Ð»Ð¾Ð½ -> ÐŸÑ€ÐµÐ´Ð¼ÐµÑ‚ ÑÐ¾Ð·Ð´Ð°ÐµÑ‚ÑÑ Ð² Ð¸Ð½Ð²ÐµÐ½Ñ‚Ð°Ñ€Ðµ.

Advanced: Ð¢ÐµÐºÑÑ‚Ð¾Ð²Ñ‹Ð¹ Ð²Ð²Ð¾Ð´ JSON Ð´Ð»Ñ ÑÐ¾Ð·Ð´Ð°Ð½Ð¸Ñ ÐºÐ°ÑÑ‚Ð¾Ð¼Ð½Ð¾Ð³Ð¾ Ð¿Ñ€ÐµÐ´Ð¼ÐµÑ‚Ð° Ð½Ð° Ð»ÐµÑ‚Ñƒ.

2. ðŸ’° Ð ÐµÑÑƒÑ€ÑÑ‹ (Add Resources)
ÐšÐ½Ð¾Ð¿ÐºÐ¸: +1000 ÐŸÑ‹Ð»Ð¸, +10 Ð¡Ð»Ð¸Ñ‚ÐºÐ¾Ð², +100 ÐšÐ¾Ð¶Ð¸.

Ð ÐµÐ°Ð»Ð¸Ð·Ð°Ñ†Ð¸Ñ: ÐŸÑ€ÑÐ¼Ð¾Ð¹ Ð²Ñ‹Ð·Ð¾Ð² WalletRepo.add_resource().

3. ðŸŒ€ Ð¢ÐµÐ»ÐµÐ¿Ð¾Ñ€Ñ‚ (Teleport)
Ð›Ð¾Ð³Ð¸ÐºÐ°: ÐŸÐ¾ÐºÐ°Ð·Ð°Ñ‚ÑŒ ÑÐ¿Ð¸ÑÐ¾Ðº Ð²ÑÐµÑ… Ð»Ð¾ÐºÐ°Ñ†Ð¸Ð¹ Ð¸Ð· WORLD_DATA.

Ð”ÐµÐ¹ÑÑ‚Ð²Ð¸Ðµ: ÐŸÑ€Ð¸Ð½ÑƒÐ´Ð¸Ñ‚ÐµÐ»ÑŒÐ½Ð¾ Ð¸Ð·Ð¼ÐµÐ½Ð¸Ñ‚ÑŒ location_id Ð² Redis Ð¸ Ð²Ñ‹Ð·Ð²Ð°Ñ‚ÑŒ NavigationService.reload_current_ui(). ÐŸÐ¾Ð»ÐµÐ·Ð½Ð¾, ÐµÑÐ»Ð¸ Ð·Ð°ÑÑ‚Ñ€ÑÐ» Ð² ÑÑ‚ÐµÐ½Ðµ.

4. ðŸ’€ Ð¡Ð±Ñ€Ð¾Ñ ÐŸÐµÑ€ÑÐ¾Ð½Ð°Ð¶Ð° (Wipe Self)
Ð”ÐµÐ¹ÑÑ‚Ð²Ð¸Ðµ: ÐŸÐ¾Ð»Ð½Ð¾Ðµ ÑƒÐ´Ð°Ð»ÐµÐ½Ð¸Ðµ ÑÐ²Ð¾ÐµÐ³Ð¾ Ð¿ÐµÑ€ÑÐ¾Ð½Ð°Ð¶Ð° Ð¸Ð· Ð‘Ð” Ð¸ Redis. Ð”Ð»Ñ Ð±Ñ‹ÑÑ‚Ñ€Ð¾Ð³Ð¾ Ñ€ÐµÑ‚ÐµÑÑ‚Ð° "ÐÐ¾Ð²Ð¾Ð¹ Ð¸Ð³Ñ€Ñ‹".

3. Ð ÐµÐ°Ð»Ð¸Ð·Ð°Ñ†Ð¸Ñ Ð² ÐºÐ¾Ð´Ðµ (ÐŸÐ»Ð°Ð½)
Ð¤Ð°Ð¹Ð»Ð¾Ð²Ð°Ñ ÑÑ‚Ñ€ÑƒÐºÑ‚ÑƒÑ€Ð°
app/handlers/admin/__init__.py â€” Ð Ð¾ÑƒÑ‚ÐµÑ€.

app/handlers/admin/admin_menu.py â€” Ð¥ÑÐ½Ð´Ð»ÐµÑ€ ÐºÐ¾Ð¼Ð°Ð½Ð´Ñ‹ /admin Ð¸ Ð¼ÐµÐ½ÑŽ.

app/handlers/admin/admin_tools.py â€” Ð›Ð¾Ð³Ð¸ÐºÐ° Ð²Ñ‹Ð´Ð°Ñ‡Ð¸ Ð¸ Ñ‚ÐµÐ»ÐµÐ¿Ð¾Ñ€Ñ‚Ð°.

app/filters/is_admin.py â€” Ð¤Ð¸Ð»ÑŒÑ‚Ñ€ Ð¿Ñ€Ð¾Ð²ÐµÑ€ÐºÐ¸ ID.

ÐŸÑ€Ð¸Ð¼ÐµÑ€ Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ð½Ð¸Ñ Ð¤Ð¸Ð»ÑŒÑ‚Ñ€Ð°
Python

# app/filters/is_admin.py
from aiogram.filters import BaseFilter
from aiogram.types import Message
from app.core.config import ADMIN_IDS # ÐÑƒÐ¶Ð½Ð¾ Ð´Ð¾Ð±Ð°Ð²Ð¸Ñ‚ÑŒ Ð² config.py

class IsAdmin(BaseFilter):
    async def __call__(self, message: Message) -> bool:
        return message.from_user.id in ADMIN_IDS