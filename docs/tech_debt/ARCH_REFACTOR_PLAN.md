# –ü–ª–∞–Ω —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥–∞ –ø–µ—Ä–µ–¥ —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ–º –Ω–∞ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã (Pre-Docker/Postgres)

**–°—Ç–∞—Ç—É—Å:** –í –ø—Ä–æ—Ü–µ—Å—Å–µ
**–¶–µ–ª—å:** –£—Å—Ç—Ä–∞–Ω–∏—Ç—å –ø—Ä—è–º—ã–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –º–µ–∂–¥—É `Bot Layer` –∏ `Game Core Layer` –¥–ª—è –æ–±–µ—Å–ø–µ—á–µ–Ω–∏—è —Ä–∞–±–æ—Ç—ã —á–µ—Ä–µ–∑ API Gateway.

## 1. UI Services (–°–ª–æ–π –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏—è)

### A. MenuService (`apps/bot/ui_service/menu_service.py`)
* **–°—Ç–∞—Ç—É—Å:** üü° **–í –ø—Ä–æ—Ü–µ—Å—Å–µ**
* **–ü—Ä–æ–±–ª–µ–º–∞:** –ò–º–ø–æ—Ä—Ç–∏—Ä—É–µ—Ç `GameSyncService` –¥–ª—è —Ä–µ–≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ HP/Energy –ø—Ä–∏ –æ—Ç—Ä–∏—Å–æ–≤–∫–µ.
* **–†–µ—à–µ–Ω–∏–µ:**
    * –í—ã–Ω–µ—Å—Ç–∏ —Ä–µ–≥–µ–Ω–µ—Ä–∞—Ü–∏—é –≤ —Ñ–æ–Ω–æ–≤—ã–π –ø—Ä–æ—Ü–µ—Å—Å (Celery/Cron/System Ticks), –∫–æ—Ç–æ—Ä—ã–π –∫—Ä—É—Ç–∏—Ç—Å—è –≤ –æ—Ç–¥–µ–ª—å–Ω–æ–º –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–µ.
    * –ú–µ–Ω—é –¥–æ–ª–∂–Ω–æ —Ç–æ–ª—å–∫–æ *—á–∏—Ç–∞—Ç—å* —Ç–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ –∏–∑ Redis, –Ω–µ –∏–Ω–∏—Ü–∏–∏—Ä—É—è —Ä–∞—Å—á–µ—Ç—ã.

### B. ExplorationService (—Ä–∞–Ω–µ–µ NavigationService)
* **–°—Ç–∞—Ç—É—Å:** ‚úÖ **–†–ï–®–ï–ù–û**
* **–ß—Ç–æ –±—ã–ª–æ —Å–¥–µ–ª–∞–Ω–æ:**
    * `NavigationService` –±—ã–ª –ø–æ–ª–Ω–æ—Å—Ç—å—é –ø–µ—Ä–µ–ø–∏—Å–∞–Ω –≤ `ExplorationService`.
    * –õ–æ–≥–∏–∫–∞ —Ä–∞–±–æ—Ç—ã —Å –º–∏—Ä–æ–º –≤—ã–Ω–µ—Å–µ–Ω–∞ –≤ `ZoneOrchestrator` (Game Core), –∫–æ—Ç–æ—Ä—ã–π –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç —É–Ω–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –¥–ª—è –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏—è –ª–æ–∫–∞—Ü–∏–π.
    * `ExplorationService` (UI Layer) —Ç–µ–ø–µ—Ä—å —Ç–æ–ª—å–∫–æ –∑–∞–ø—Ä–∞—à–∏–≤–∞–µ—Ç —É `ZoneOrchestrator` –¥–∞–Ω–Ω—ã–µ –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –∏ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –µ–º—É –∫–æ–º–∞–Ω–¥—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (`move`, `scan`), –Ω–µ —Ä–∞–±–æ—Ç–∞—è —Å –ë–î –∏–ª–∏ Redis –Ω–∞–ø—Ä—è–º—É—é.
    * –≠—Ç–æ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç —Ü–µ–ª–µ–≤–æ–π –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–µ "Gateway Pattern", –≥–¥–µ UI-—Å–ª–æ–π –∏–∑–æ–ª–∏—Ä–æ–≤–∞–Ω –æ—Ç –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∏.

### C. CombatUIService (`apps/bot/ui_service/combat/combat_ui_service.py`)
* **–°—Ç–∞—Ç—É—Å:** üü° **–í –ø—Ä–æ—Ü–µ—Å—Å–µ**
* **–ü—Ä–æ–±–ª–µ–º–∞:** –ò–º–ø–æ—Ä—Ç–∏—Ä—É–µ—Ç `StatsCalculator` (Core) –¥–ª—è —Ä–∞—Å—á–µ—Ç–∞ Max HP.
* **–†–µ—à–µ–Ω–∏–µ:**
    * –°–æ–∑–¥–∞—Ç—å –§–∞—Å–∞–¥ (Facade) –≤ `CombatService` –∏–ª–∏ Helper-—Å–µ—Ä–≤–∏—Å–µ, –∫–æ—Ç–æ—Ä—ã–π –æ—Ç–¥–∞–µ—Ç –≥–æ—Ç–æ–≤—ã–µ DTO —Å —É–∂–µ –ø–æ—Å—á–∏—Ç–∞–Ω–Ω—ã–º–∏ —Å—Ç–∞—Ç–∞–º–∏.
    * UI –Ω–µ –¥–æ–ª–∂–µ–Ω –∑–Ω–∞—Ç—å —Ñ–æ—Ä–º—É–ª—ã —Ä–∞—Å—á–µ—Ç–∞ —Å—Ç–∞—Ç–æ–≤.

## 2. Handlers (–¢–æ—á–∫–∏ –≤—Ö–æ–¥–∞)

**–§–∞–π–ª—ã:**
* `apps/bot/handlers/callback/login/login_handler.py`
* `apps/bot/handlers/callback/ui/menu_dispatch.py`
* `apps/bot/handlers/callback/game/combat/action_handlers.py`

* **–°—Ç–∞—Ç—É—Å:** üî¥ **–ù–ï –ù–ê–ß–ê–¢–û**
* **–ü—Ä–æ–±–ª–µ–º–∞:** "God Handlers". –û–Ω–∏ –Ω–∞–ø—Ä—è–º—É—é –∏–º–ø–æ—Ä—Ç–∏—Ä—É—é—Ç —Å–µ—Ä–≤–∏—Å—ã —è–¥—Ä–∞ (`LoginService`, `CombatService`, `GameSyncService`) –∏ —É–ø—Ä–∞–≤–ª—è—é—Ç –ª–æ–≥–∏–∫–æ–π.
* **–†–µ—à–µ–Ω–∏–µ:**
    * –ü–µ—Ä–µ–ø–∏—Å–∞—Ç—å —Ö–µ–Ω–¥–ª–µ—Ä—ã —Ç–∞–∫, —á—Ç–æ–±—ã –æ–Ω–∏ –æ–±—Ä–∞—â–∞–ª–∏—Å—å –∫ –Ø–¥—Ä—É —Ç–æ–ª—å–∫–æ —á–µ—Ä–µ–∑ –µ–¥–∏–Ω—ã–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å (–≤ –±—É–¥—É—â–µ–º ‚Äî HTTP Client –∫ FastAPI).
    * –£–±—Ä–∞—Ç—å –ª–æ–≥–∏–∫—É –æ—Ä–∫–µ—Å—Ç—Ä–∞—Ü–∏–∏ –∏–∑ —Ö–µ–Ω–¥–ª–µ—Ä–æ–≤, –æ—Å—Ç–∞–≤–∏–≤ —Ç–∞–º —Ç–æ–ª—å–∫–æ –≤—ã–∑–æ–≤ –º–µ—Ç–æ–¥–∞ –∏ –ø–µ—Ä–µ–¥–∞—á—É —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞ –≤ UI.
