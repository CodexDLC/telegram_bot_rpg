# AI Ghost Agent Specification (RBC v3.1)

## 1. Назначение
Ghost Agent — это автоматизированный компонент, который принимает решения за сущность (монстра или отсутствующего игрока) в бою.
В версии v3.1 его задача — обеспечить валидный ход в рамках новой системы "Exchange & Tactics".

## 2. Логика Принятия Решений (Decision Logic)

### Старая модель (Deprecated)
Ранее AI выбирал конкретные зоны атаки/защиты (Голова/Ноги). Эта механика удалена.

### Новая модель (Token-Based)
В каждом раунде AI должен выбрать одно действие из доступных.

#### A. Анализ Ресурсов
AI проверяет наличие **Tactical Tokens**.
*   Если токенов < Cost финта -> Доступна только **Базовая Атака**.
*   Если токенов >= Cost финта -> Доступны **Базовая Атака** и **Спецприемы (Feints)**.

#### B. Выбор Действия (Current Implementation)
На текущем этапе (v3.1 MVP) используется **Random Weighted Selection**:
1.  Собирается список всех валидных действий (на которые хватает токенов).
2.  Выбирается случайное действие.
    *   *Note:* В будущем здесь будет система весов (Weights), учитывающая HP врага, его стойку и уязвимости.

#### C. Формирование Интента
После выбора действия AI формирует стандартный Intent Object, идентичный тому, что присылает игрок.

```python
intent = {
    "source_id": "mob_123",
    "target_id": "player_456",
    "action_id": "feint_heavy_smash" # Или "basic_attack"
}
```

## 3. Уровни Сложности (Roadmap)
В данный момент AI работает в режиме "Random".
В будущем планируется внедрение системы **Behavior Trees** или **Utility AI**:

*   **Aggressive:** Приоритет на трату токенов (спам финтами).
*   **Defensive:** Приоритет на накопление токенов для защитных финтов.
*   **Adaptive:** Анализ эффективности прошлых ходов (если враг имеет высокий Armor, использовать Armor Piercing финты).

## 4. Интеграция с Воркерами
Ghost Agent запускается `TurnManager`'ом, если от живого игрока не пришел ответ за отведенное время (Timeout), или если ход принадлежит NPC.
Он работает синхронно и сразу возвращает Intent.
