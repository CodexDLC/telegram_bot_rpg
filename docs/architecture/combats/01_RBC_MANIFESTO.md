# RBC Core Concepts: The Manifesto

> **Disclaimer:** Это не Real-Time Slasher. Это Асинхронная Тактическая Стратегия.
> Бой строится на **Намерениях (Intents)**, которые всегда содержат конфигурацию Зон.

## 1. Асинхронность и Намерения
Бой не происходит в момент нажатия кнопки.
* **Игрок:** Генерирует **Намерение (Intent)**.
* **Система:** Принимает намерения в очередь `moves:{char_id}` (RedisJSON) и ждет реакции оппонентов.
* **Свобода:** Игрок может заявить несколько намерений против разных целей, пока не сработал таймаут или размен. Ему не нужно ждать анимации удара по первому врагу, чтобы заявить удар по второму.

## 2. Принцип "Полной Стойки" (Zones are Mandatory)
В любом боевом размене (Exchange) игрок **всегда** задает полную конфигурацию:
1.  **Attack Zones:** Куда я бью (например, `head`).
2.  **Block Zones:** Что я закрываю (например, `body`, `legs`).
* Нельзя "просто атаковать" или "просто блокировать".
* Даже если ты бьешь манекен, ты должен открыть какие-то зоны на себе.
* **Формула:** `Intent = Targets + AttackZones + BlockZones`.

## 3. Мульти-Таргетинг (Spamming Intents)
Структура `moves:exchange` — это **список**.
Игрок может заявить разные стойки для разных врагов одновременно:
* **Пример:**
    1.  Против Орка (101): `Atk:[Head], Blk:[Legs]` (Агрессия).
    2.  Против Элфа (102): `Atk:[Legs], Blk:[Head]` (Защита).
* **Обработка:** Менеджер обрабатывает их **независимо**.
    * Если Орк ответил — сработал первый размен (пара схлопнулась).
    * Если Элф тупит — второе намерение висит в ожидании.
* **Бой не блокируется.** Одни пары разрешаются, другие ждут.

## 4. Таймер и Наказание (AFK Logic)
Мы не ждем вечно.
* Если пара не сложилась (кто-то не ответил), тикает локальный таймер жизни "пули" (Намерения).
* **Timeout:** Если время вышло, Намерение превращается в **Forced Attack**.
* **Кара:** Спящий (Тот, кто не ответил):
    1.  Получает урон в открытую (так как не заявил свои зоны блока).
    2.  Получает штраф `afk_level` (сокращение времени на следующий ход: 60с -> 55с -> ... -> 10с).

## 5. Время (Time Flow)
* **Событийная модель:** Тиков нет, пока нет Разрешения (Resolution).
* **Расчет:** ДоТы (DoT), Кулдауны (CD) и Регенерация рассчитываются и применяются **только** в момент совершения хода (Exchange) или применения инстант-действия.
* **AFK:** Если все игроки ушли в AFK — сервер спит. Нагрузка 0.
* **Catch-up:** Как только срабатывает Timeout (по сигналу или проверке) — время "догоняется" пакетом для участников события.
