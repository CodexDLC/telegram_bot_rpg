# Component: ChaosTask

‚¨ÖÔ∏è [–ù–∞–∑–∞–¥](../README.md) | üè† [–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è](../../../../README.md)

**File:** `apps/game_core/modules/combat/combat_engine/workers/tasks/chaos_task.py`
**Responsibility:** –ü–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ —Å–µ—Å—Å–∏–∏ (Garbage Collector).

## 1. –ê–ª–≥–æ—Ä–∏—Ç–º –≠—Å—Ç–∞—Ñ–µ—Ç—ã (Relay)
–ó–∞–¥–∞—á–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç –ø–æ –ø—Ä–∏–Ω—Ü–∏–ø—É —Å–∞–º–æ–≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏—è.
1.  **Check:** –ü—Ä–æ–≤–µ—Ä—è–µ—Ç `last_activity_at` –≤ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã—Ö —Å–µ—Å—Å–∏–∏.
2.  **Spawn:** –ï—Å–ª–∏ –ø—Ä–æ—Å—Ç–æ–π > 10 –º–∏–Ω—É—Ç -> –í—ã–∑—ã–≤–∞–µ—Ç `ChaosService.spawn_cleaner`.
3.  **Relay:** –ï—Å–ª–∏ —Å–µ—Å—Å–∏—è –µ—â–µ –∞–∫—Ç–∏–≤–Ω–∞ -> –°—Ç–∞–≤–∏—Ç –Ω–æ–≤—É—é –∑–∞–¥–∞—á—É `chaos_check_task` —á–µ—Ä–µ–∑ 5 –º–∏–Ω—É—Ç.
4.  **Stop:** –ï—Å–ª–∏ —Å–µ—Å—Å–∏—è –∑–∞–∫—Ä—ã—Ç–∞ (`active=0`) -> –≠—Å—Ç–∞—Ñ–µ—Ç–∞ –ø—Ä–µ—Ä—ã–≤–∞–µ—Ç—Å—è.

## 2. –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è
*   –ü–µ—Ä–≤—ã–π –∑–∞–ø—É—Å–∫ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –≤ `CombatLifecycleService.create_battle`.
*   –ò—Å–ø–æ–ª—å–∑—É–µ—Ç `CombatDataService` –¥–ª—è —á—Ç–µ–Ω–∏—è –º–µ—Ç—ã.
