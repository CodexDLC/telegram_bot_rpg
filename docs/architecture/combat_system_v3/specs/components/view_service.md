# Component: CombatViewService

‚¨ÖÔ∏è [–ù–∞–∑–∞–¥](../README.md) | üè† [–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è](../../../../README.md)

**File:** `apps/game_core/modules/combat/session/runtime/combat_view_service.py`
**Layer:** API Layer (Presenter).
**Responsibility:** –ü—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ –≤–Ω—É—Ç—Ä–µ–Ω–Ω–µ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è (`BattleContext`) –≤ DTO –¥–ª—è –∫–ª–∏–µ–Ω—Ç–∞ (`CombatDashboardDTO`).

## 1. –õ–æ–≥–∏–∫–∞ –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è

### A. –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –°—Ç–∞—Ç—É—Å–∞
–°–µ—Ä–≤–∏—Å –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç, —á—Ç–æ –ø–æ–∫–∞–∑–∞—Ç—å –∏–≥—Ä–æ–∫—É (–∫–Ω–æ–ø–∫–∏ –∞—Ç–∞–∫–∏ –∏–ª–∏ —ç–∫—Ä–∞–Ω –æ–∂–∏–¥–∞–Ω–∏—è).
*   **Finished:** –ï—Å–ª–∏ –±–æ–π –∑–∞–≤–µ—Ä—à–µ–Ω (`meta.active == 0`).
*   **Waiting:** –ï—Å–ª–∏ –æ—á–µ—Ä–µ–¥—å —Ü–µ–ª–µ–π –ø—É—Å—Ç–∞ (–≤—Å–µ –≤—Ä–∞–≥–∏ —É–±–∏—Ç—ã –∏–ª–∏ –µ—â–µ –Ω–µ –Ω–∞–∑–Ω–∞—á–µ–Ω—ã).
*   **Active:** –ï—Å–ª–∏ –µ—Å—Ç—å —Ü–µ–ª—å –≤ –æ—á–µ—Ä–µ–¥–∏.

### B. –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –¶–µ–ª–∏
*   –ë–µ—Ä–µ—Ç –ø–µ—Ä–≤—ã–π ID –∏–∑ –æ—á–µ—Ä–µ–¥–∏ `targets` –∏–≥—Ä–æ–∫–∞.
*   –ù–∞—Ö–æ–¥–∏—Ç –¥–∞–Ω–Ω—ã–µ —ç—Ç–æ–≥–æ –∞–∫—Ç–µ—Ä–∞ –≤ –∫–æ–Ω—Ç–µ–∫—Å—Ç–µ.
*   –ï—Å–ª–∏ –¥–∞–Ω–Ω—ã–µ –µ—Å—Ç—å -> –û—Ç–æ–±—Ä–∞–∂–∞–µ—Ç –∫–∞–∫ `target`.

### C. –°–ø–∏—Å–∫–∏ (Allies / Enemies)
*   –§–∏–ª—å—Ç—Ä—É–µ—Ç –≤—Å–µ—Ö —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤ –ø–æ –∫–æ–º–∞–Ω–¥–∞–º.
*   –°–æ—Ä—Ç–∏—Ä—É–µ—Ç: –ñ–∏–≤—ã–µ –≤—ã—à–µ, –ú–µ—Ä—Ç–≤—ã–µ –Ω–∏–∂–µ.
*   –ü–æ–º–µ—á–∞–µ—Ç —Ç–µ–∫—É—â—É—é —Ü–µ–ª—å —Ñ–ª–∞–≥–æ–º `is_target`.

## 2. –ú–∞–ø–ø–∏–Ω–≥ (DTO)
*   **ActorFullInfo:** –î–ª—è –ì–µ—Ä–æ—è –∏ –¶–µ–ª–∏ (HP, Energy, Tokens, Effects).
*   **ActorShortInfo:** –î–ª—è —Å–ø–∏—Å–∫–æ–≤ (HP%, Dead/Alive).
