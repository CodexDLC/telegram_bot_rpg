# Component: CombatSessionService

‚¨ÖÔ∏è [–ù–∞–∑–∞–¥](../../README.md) | üè† [–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è](../../../../../README.md)

**File:** `apps/game_core/modules/combat/session/combat_session_service.py`
**Layer:** API Data Layer (Client Side).
**Responsibility:** –§–∞—Å–∞–¥ –¥–ª—è UI –∏ Ingress. –†–∞–±–æ—Ç–∞–µ—Ç –≤ –∫–æ–Ω—Ç–µ–∫—Å—Ç–µ `char_id` (–Ω–∞—Ö–æ–¥–∏—Ç —Å–µ—Å—Å–∏—é —Å–∞–º).

## 1. Public API

### A. Actions
*   `register_move(char_id, payload)`:
    1.  –ù–∞—Ö–æ–¥–∏—Ç `session_id`.
    2.  –†–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–µ—Ç —Ö–æ–¥ —á–µ—Ä–µ–∑ `TurnManager`.
    3.  –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç –∞–∫—Ç—É–∞–ª—å–Ω—ã–π —Å–Ω–∞–ø—à–æ—Ç (Dashboard).

### B. Read Models
*   `get_snapshot(char_id)`:
    1.  –ó–∞–≥—Ä—É–∂–∞–µ—Ç **–ª–µ–≥–∫–∏–π** –∫–æ–Ω—Ç–µ–∫—Å—Ç (–±–µ–∑ XP –∏ —Ç—è–∂–µ–ª–æ–π –º–∞—Ç–µ–º–∞—Ç–∏–∫–∏).
    2.  –ò—Å–ø–æ–ª—å–∑—É–µ—Ç `CombatViewService` –¥–ª—è –ø—Ä–µ–≤—Ä–∞—â–µ–Ω–∏—è –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ –≤ `CombatDashboardDTO` (–¥–ª—è —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–∞).
*   `get_logs(char_id)`: –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç –∏—Å—Ç–æ—Ä–∏—é –±–æ—è.

## 2. –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è
–°–µ—Ä–≤–∏—Å –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã–µ –º–µ—Ç–æ–¥—ã –∑–∞–≥—Ä—É–∑–∫–∏ (`_load_snapshot_context`), –∫–æ—Ç–æ—Ä—ã–µ —Ç—è–Ω—É—Ç –∏–∑ Redis —Ç–æ–ª—å–∫–æ —Ç–æ, —á—Ç–æ –Ω—É–∂–Ω–æ –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è (HP, Energy, Names, Active Effects), –∏–≥–Ω–æ—Ä–∏—Ä—É—è —Å–∫—Ä—ã—Ç—ã–µ –º–µ—Ö–∞–Ω–∏–∫–∏.
