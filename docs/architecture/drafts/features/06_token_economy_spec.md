# Token Economy Specification (RBC v3.1)

## 1. Overview
Экономика токенов в боевой системе управляет темпом боя и вознаграждением игрока.
Она делится на **Combat Economy** (внутри боя) и **Meta Economy** (награды после боя).

## 2. Combat Economy (Tactical Tokens)
В отличие от маны или стамины, тактические токены — это дискретный ресурс, накапливаемый за успешные действия.
Система поддерживает расширяемый набор типов токенов (минимум 7 базовых типов), разделенных на три группы.

### A. Типы Токенов (Token Taxonomy)

#### Group 1: Offensive Tokens (Атакующие)
Выдаются за успешные активные действия в свой ход.
1.  **Hit Token:** За любое успешное попадание (нанесение урона).
2.  **Crit Token:** За критический удар (обычно выдается вместе с Hit Token).

#### Group 2: Defensive Tokens (Защитные)
Выдаются за успешное предотвращение урона в ход противника.
3.  **Block Token:** За успешное блокирование урона (щитом или оружием).
4.  **Dodge Token:** За полный уворот от атаки.
5.  **Parry Token:** За идеальное парирование (активная защита).

#### Group 3: Tactical Tokens (Тактические)
Выдаются за сложные взаимодействия, ошибки врага или контроль поля боя.
6.  **Tempo Token:** Выдается **Защитнику**, если Атакующий провалил атаку (промахнулся, попал в блок или парирование). Символизирует перехват инициативы.
7.  **Counter Token:** За успешную контратаку (удар в ответ).
8.  **Control Token (Draft):** За наложение эффекта контроля (Stun, Knockdown). Позволяет активировать "Finisher" приемы.

### B. Механика Выдачи
Токены выдаются `CombatCalculator`'ом в объекте `ResultDTO`.
Логика выдачи может быть настроена через триггеры (например, пассивка "Мастер щита" дает 2 Block Tokens вместо 1).

### C. Трата (Spending)
Токены используются для активации **Финтов (Feints)**.
*   Стоимость финта может требовать комбинацию токенов (например, `2 Hit + 1 Tempo`).
*   Ультимативные финты требуют накопления редких токенов (Crit/Parry).

### D. Сгорание (Decay)
Токены могут сгорать, если бой затягивается или игрок бездействует (механика Anti-Stalling, опционально).

---

## 3. Meta Economy (Rift Rewards)
Система наград за победу над монстрами или прохождение Рифта.

### A. Принципы Генерации
Награды не фиксированы, а генерируются из **Loot Tables** с учетом модификаторов Рифта.

### B. Типы Наград
1.  **Currency:** Золото, Осколки Рифта.
2.  **Experience:** XP персонажа, XP навыков (Weapon Mastery).
3.  **Items:** Экипировка, Расходники.

### C. Формула (Abstract)
```
FinalReward = BaseLootTable * (1 + RiftDifficultyMod) * (1 + PlayerLuckMod)
```

### D. Progression Example (Draft)
Пример того, как масштабируются награды в зависимости от уровня Рифта.

| Rift Tier | Boss HP (Approx) | Crystal Drop | XP Value | Craft Value |
|-----------|------------------|--------------|----------|-------------|
| 1 (Easy)  | 500              | Fragment (T1)| 100 XP   | 10 Dust     |
| 3 (Med)   | 2000             | Shard (T3)   | 500 XP   | 100 Dust    |
| 7 (Hell)  | 10000            | Star (T7)    | 5000 XP  | 1000 Dust   |

> **Note:** Конкретные таблицы лута и коэффициенты баланса находятся в конфигурационных файлах (JSON) и не являются частью архитектурной спецификации.
