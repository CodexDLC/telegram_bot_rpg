# ⚙️ Топология Мира и Система Латентности

Спецификация хранения и генерации игрового пространства.

## 1. Иерархия Мира (Point of Interest Graph)
Мир не является бесшовной картой, это граф локаций с жесткой вложенностью:
*   **Регионы (Макро):** Сетка 7x7 (от A1 до G7).
*   **Зоны (Микро):** Каждый регион состоит из 9 Зон (3x3).
*   **Клетки (Нано):** Каждая Зона — это квадрат 5x5 клеток. Одна клетка = одна полноценная локация.
*   **Масштаб:** Всего в системе заложено 11 025 уникальных локаций.

## 2. Сектор D4 (Стартовый кластер)
*   **Структура:** Сетка 15x15 нод (225 клеток), окруженная «Внешней Стеной».
*   **Хаб:** Локация [1,1] по сетке секторов, физически занимает центральную Зону 5x5 клеток.

## 3. Принцип «Латентного Мира» (The Latent World)
Система минимизирует нагрузку на БД и LLM за счет статуса активации:
*   **PostgreSQL (Матрица):** Хранит данные обо всех 11 025 клетках. Для большинства установлен флаг `is_active = False` (только биом и координаты).
*   **Redis (Сцена):** Кэширует только активные клетки для мгновенной навигации. Перемещение игроков происходит исключительно через Redis.

## 4. Механика «Пробуждения» (World Awakening)
*   **Активация Зонами:** Контент генерируется не по одной клетке, а чанками (Зонами) 5x5.
*   **ZoneOrchestrator:** При приближении игрока к границе «Тумана» или по триггеру квеста, оркестратор заказывает генерацию контента для всех 25 клеток Зоны сразу, сохраняет их в Postgres и загружает в Redis.
*   **Каскадная генерация:** Если маршрут квеста проходит через «спящие» зоны, система последовательно пробуждает их на пути следования.