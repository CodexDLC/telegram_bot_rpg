# üìú Game Menu Manifest

## 1. Definition (–û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ)
**Game Menu** ‚Äî —ç—Ç–æ –¥–æ–º–µ–Ω, –æ–±–µ—Å–ø–µ—á–∏–≤–∞—é—â–∏–π —Ä–∞–±–æ—Ç—É –ø–æ—Å—Ç–æ—è–Ω–Ω–æ–≥–æ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–Ω–æ–≥–æ —ç–ª–µ–º–µ–Ω—Ç–∞ ("–í–µ—Ä—Ö–Ω–µ–≥–æ —Å–æ–æ–±—â–µ–Ω–∏—è"), –∫–æ—Ç–æ—Ä—ã–π –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç –∫—Ä–∞—Ç–∫–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ –ø–µ—Ä—Å–æ–Ω–∞–∂–∞ (HUD) –∏ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç —Ç–æ—á–∫–∏ –≤—Ö–æ–¥–∞ –≤ –æ—Å–Ω–æ–≤–Ω—ã–µ –∏–≥—Ä–æ–≤—ã–µ –º–æ–¥—É–ª–∏ (Navigation, Inventory, Status).

### üéØ Goals (–¶–µ–ª–∏)
1.  **Centralized HUD:** –ü—Ä–µ–¥–æ—Å—Ç–∞–≤–ª–µ–Ω–∏–µ –µ–¥–∏–Ω–æ–≥–æ –∏—Å—Ç–æ—á–Ω–∏–∫–∞ –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è HP, Energy –∏ —Å—Ç–∞—Ç—É—Å–æ–≤ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏.
2.  **Fast Access:** –ü–æ–ª—É—á–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –Ω–∞–ø—Ä—è–º—É—é –∏–∑ **Redis** (Hot Data) –±–µ–∑ —Ç—è–∂–µ–ª—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤ –≤ –ë–î.
3.  **Clean Architecture:** –ò–∑–æ–ª—è—Ü–∏—è –ª–æ–≥–∏–∫–∏ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –æ—Ç –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∏. –ö–ª–∏–µ–Ω—Ç –ø–æ–ª—É—á–∞–µ—Ç –≥–æ—Ç–æ–≤–æ–µ DTO.

---

## 2. Boundaries (–ì—Ä–∞–Ω–∏—Ü—ã)

### ‚úÖ In Scope (–í—Ö–æ–¥–∏—Ç –≤ –¥–æ–º–µ–Ω)
*   **Data Aggregation:** –°–±–æ—Ä –¥–∞–Ω–Ω—ã—Ö –¥–ª—è HUD (HP/MaxHP, Energy/MaxEnergy, Name, Active Buffs icons) –∏–∑ Redis –∫–ª—é—á–µ–π.
*   **Lazy Regeneration:** –†–∞—Å—á–µ—Ç –∞–∫—Ç—É–∞–ª—å–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π HP/Energy –Ω–∞ –æ—Å–Ω–æ–≤–µ –≤—Ä–µ–º–µ–Ω–∏ (TimeDelta) –ø—Ä–∏ —á—Ç–µ–Ω–∏–∏.
*   **Menu Configuration:** –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞ –¥–æ—Å—Ç—É–ø–Ω—ã—Ö –∫–Ω–æ–ø–æ–∫.
*   **UI Rendering:** –§–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–µ —Ç–µ–∫—Å—Ç–∞ —Å–æ–æ–±—â–µ–Ω–∏—è –∏ –∫–ª–∞–≤–∏–∞—Ç—É—Ä—ã (InlineKeyboard).
*   **Action Routing:** –û–±—Ä–∞–±–æ—Ç–∫–∞ –Ω–∞–∂–∞—Ç–∏–π –Ω–∞ –∫–Ω–æ–ø–∫–∏ –º–µ–Ω—é.

### ‚ùå Out of Scope (–ù–µ –≤—Ö–æ–¥–∏—Ç)
*   **Stat Formulas:** –î–æ–º–µ–Ω –Ω–µ —Ä–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ—Ç *–º–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–µ* –∑–Ω–∞—á–µ–Ω–∏—è (MaxHP, MaxEnergy) –∏ —Ñ–æ—Ä–º—É–ª—ã —É—Ä–æ–Ω–∞. –û–Ω –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –≥–æ—Ç–æ–≤—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –∏–∑ –∫—ç—à–∞.
*   **Feature Implementation:** –î–æ–º–µ–Ω –Ω–µ —Ä–µ–∞–ª–∏–∑—É–µ—Ç –ª–æ–≥–∏–∫—É –ò–Ω–≤–µ–Ω—Ç–∞—Ä—è –∏–ª–∏ –ë–æ—è.
*   **Combat HUD:** –í–Ω—É—Ç—Ä–∏ –±–æ—è –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Å–≤–æ–π —Å–ø–µ—Ü–∏—Ñ–∏—á–Ω—ã–π HUD.

---

## 3. Architecture (–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞)

### üèóÔ∏è Components
1.  **Backend Service (Internal Domain):**
    *   `GameMenuService`: –ê–≥—Ä–µ–≥–∞—Ç–æ—Ä –¥–∞–Ω–Ω—ã—Ö (Redis Reader).
    *   `API`: Endpoint `GET /game-menu/view` (–≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç DTO).
2.  **Client Orchestrator (Bot):**
    *   `MenuBotOrchestrator`: –£–ø—Ä–∞–≤–ª—è–µ—Ç –∂–∏–∑–Ω–µ–Ω–Ω—ã–º —Ü–∏–∫–ª–æ–º —Å–æ–æ–±—â–µ–Ω–∏—è –º–µ–Ω—é.
    *   `MenuClient`: –ö–ª–∏–µ–Ω—Ç –¥–ª—è –æ–±—â–µ–Ω–∏—è —Å –±—ç–∫–µ–Ω–¥–æ–º.

### üîÑ Data Flow
1.  **Client** –∑–∞–ø—Ä–∞—à–∏–≤–∞–µ—Ç –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –º–µ–Ω—é.
2.  **Backend** —á–∏—Ç–∞–µ—Ç –≥–æ—Ä—è—á–∏–µ –¥–∞–Ω–Ω—ã–µ –∏–∑ **Redis** (AccountManager/StatusManager).
3.  **Backend** —Ñ–æ—Ä–º–∏—Ä—É–µ—Ç `GameMenuDTO` (—Ç–µ–∫—Å—Ç + —Å–ø–∏—Å–æ–∫ –∫–Ω–æ–ø–æ–∫).
4.  **Client** —Ä–µ–Ω–¥–µ—Ä–∏—Ç —Å–æ–æ–±—â–µ–Ω–∏–µ.

---

## 4. Dependencies (–ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏)
*   `Infrastructure.Redis` (Source of Truth for HUD)
*   `User_Features.Status` (Logic owner of Vitals)
