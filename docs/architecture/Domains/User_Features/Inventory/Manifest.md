# üèóÔ∏è Inventory Architecture (–ú–∞–Ω–∏—Ñ–µ—Å—Ç)

[‚¨ÖÔ∏è –ù–∞–∑–∞–¥: Inventory Domain](./README.md)

---

## üéØ –¶–µ–ª—å
–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∏–Ω–≤–µ–Ω—Ç–∞—Ä—ë–º —Å –≤—ã—Å–æ–∫–æ–π –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å—é (Redis) –∏ –Ω–∞–¥–µ–∂–Ω–æ—Å—Ç—å—é (PostgreSQL).

## üîë –ü—Ä–∏–Ω—Ü–∏–ø—ã
1.  **Redis-First:** –í—Å–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ (—ç–∫–∏–ø–∏—Ä–æ–≤–∫–∞, –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ) –ø—Ä–æ–∏—Å—Ö–æ–¥—è—Ç –≤ Redis.
2.  **Dirty Flags:** –ò–∑–º–µ–Ω–µ–Ω–∏—è –Ω–∞–∫–∞–ø–ª–∏–≤–∞—é—Ç—Å—è –∏ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ –ë–î —Ç–æ–ª—å–∫–æ –ø—Ä–∏ –∑–∞–≤–µ—Ä—à–µ–Ω–∏–∏ —Å–µ—Å—Å–∏–∏.
3.  **Snapshot:** –ò–Ω–≤–µ–Ω—Ç–∞—Ä—å –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è –∏–∑ –ë–î –æ–¥–∏–Ω —Ä–∞–∑ (—á–µ—Ä–µ–∑ ContextAssembler) –∏ –∫—ç—à–∏—Ä—É–µ—Ç—Å—è.

## üß© –ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã

### 1. InventoryGateway
–ï–¥–∏–Ω–∞—è —Ç–æ—á–∫–∞ –≤—Ö–æ–¥–∞. –ü—Ä–∏–Ω–∏–º–∞–µ—Ç –∑–∞–ø—Ä–æ—Å—ã –æ—Ç Router/API –∏ –ø–µ—Ä–µ–¥–∞–µ—Ç –∏—Ö –≤ Service.

### 2. InventoryService
–ë–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞.
*   `equip_item()`
*   `use_consumable()`
*   `move_item()`

### 3. InventorySessionManager
–£–ø—Ä–∞–≤–ª—è–µ—Ç –∂–∏–∑–Ω–µ–Ω–Ω—ã–º —Ü–∏–∫–ª–æ–º —Å–µ—Å—Å–∏–∏ –≤ Redis.
*   `load_session()`
*   `save_session()` (—Å –ø—Ä–æ–≤–µ—Ä–∫–æ–π dirty flag)

### 4. InventoryFormatter
–ü—Ä–µ–≤—Ä–∞—â–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ —Å–µ—Å—Å–∏–∏ –≤ –∫—Ä–∞—Å–∏–≤—ã–π JSON/Text –¥–ª—è UI.
