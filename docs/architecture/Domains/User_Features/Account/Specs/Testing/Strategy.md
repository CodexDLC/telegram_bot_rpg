# üß™ Account Testing Strategy

[‚¨ÖÔ∏è –ù–∞–∑–∞–¥: Account Domain](../../README.md)

---

## üéØ –§–∏–ª–æ—Å–æ—Ñ–∏—è
–ú—ã —Å–ª–µ–¥—É–µ–º –≥–ª–æ–±–∞–ª—å–Ω–æ–º—É [Testing Standard](../../../../../management/Standards/Testing_Standard.md).

### –°–ø–µ—Ü–∏—Ñ–∏–∫–∞ Account Domain
–ê–∫–∫–∞—É–Ω—Ç ‚Äî —ç—Ç–æ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ–º –∏ –¥–∞–Ω–Ω—ã–º–∏.
–ì–ª–∞–≤–Ω—ã–π —Ñ–æ–∫—É—Å —Ç–µ—Å—Ç–æ–≤ ‚Äî **—Ü–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç—å –¥–∞–Ω–Ω—ã—Ö (Data Integrity)** –∏ **–∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç—å –ø–æ—Ç–æ–∫–æ–≤ (Flows)**.

---

## üìä –ü–ª–∞–Ω –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è (Backend)

### 1. Unit Tests (Services)
*   **Focus:** –ë–∏–∑–Ω–µ—Å-–ø—Ä–∞–≤–∏–ª–∞ (–ª–∏–º–∏—Ç—ã –ø–µ—Ä—Å–æ–Ω–∞–∂–µ–π, –≤–∞–ª–∏–¥–∞—Ü–∏—è –∏–º–µ–Ω).
*   **–ü—Ä–∏–Ω—Ü–∏–ø:** –ú–æ–∫–∞–µ–º Repositories. –ü—Ä–æ–≤–µ—Ä—è–µ–º, —á—Ç–æ —Å–µ—Ä–≤–∏—Å –≤—ã–±—Ä–∞—Å—ã–≤–∞–µ—Ç –æ—à–∏–±–∫–∏ –ø—Ä–∏ –Ω–∞—Ä—É—à–µ–Ω–∏–∏ –ø—Ä–∞–≤–∏–ª.

**–ö–ª—é—á–µ–≤—ã–µ –∫–µ–π—Å—ã:**
*   `test_create_character_limit`: –û—à–∏–±–∫–∞ –ø—Ä–∏ –ø–æ–ø—ã—Ç–∫–µ —Å–æ–∑–¥–∞—Ç—å 5-–≥–æ –ø–µ—Ä—Å–æ–Ω–∞–∂–∞.
*   `test_delete_character_ownership`: –û—à–∏–±–∫–∞ –ø—Ä–∏ –ø–æ–ø—ã—Ç–∫–µ —É–¥–∞–ª–∏—Ç—å —á—É–∂–æ–≥–æ –ø–µ—Ä—Å–æ–Ω–∞–∂–∞.
*   `test_onboarding_validation`: –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤–∞–ª–∏–¥–∞—Ü–∏–∏ –∏–º–µ–Ω–∏ (–¥–ª–∏–Ω–∞, –∑–∞–ø—Ä–µ—â–µ–Ω–Ω—ã–µ —Å–∏–º–≤–æ–ª—ã) –∏ –ø–æ–ª–∞.
*   `test_login_routing`: –ü—Ä–æ–≤–µ—Ä–∫–∞, —á—Ç–æ –ª–æ–≥–∏–Ω –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π —Å—Ç–µ–π—Ç (Combat/Exploration) –Ω–∞ –æ—Å–Ω–æ–≤–µ –¥–∞–Ω–Ω—ã—Ö –∏–∑ –ë–î.

### 2. Integration Tests (Gateway & DB)
*   **Focus:** –í–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ —Å PostgreSQL –∏ Redis.
*   **–ü—Ä–∏–Ω—Ü–∏–ø:** –ò—Å–ø–æ–ª—å–∑—É–µ–º —Ç–µ—Å—Ç–æ–≤—É—é –ë–î (Docker) –∏ —Ä–µ–∞–ª—å–Ω—ã–π Redis.

**–ö–ª—é—á–µ–≤—ã–µ –∫–µ–π—Å—ã:**
*   `test_user_upsert`: –°–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–≥–æ.
*   `test_character_crud`: –ü–æ–ª–Ω—ã–π —Ü–∏–∫–ª (Create -> Read -> Delete). –ü—Ä–æ–≤–µ—Ä–∫–∞, —á—Ç–æ –∑–∞–ø–∏—Å—å –ø–æ—è–≤–ª—è–µ—Ç—Å—è –∏ –∏—Å—á–µ–∑–∞–µ—Ç –≤ –ë–î.
*   `test_lobby_cache_invalidation`:
    1. –ó–∞–ø—Ä–æ—Å–∏—Ç—å —Å–ø–∏—Å–æ–∫ (Cache Miss -> DB -> Cache Hit).
    2. –°–æ–∑–¥–∞—Ç—å –ø–µ—Ä—Å–æ–Ω–∞–∂–∞.
    3. –ó–∞–ø—Ä–æ—Å–∏—Ç—å —Å–ø–∏—Å–æ–∫ —Å–Ω–æ–≤–∞ (–¥–æ–ª–∂–µ–Ω –±—ã—Ç—å Cache Miss –∏ –Ω–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ).
*   `test_redis_json_structure`: –ü—Ä–æ–≤–µ—Ä–∫–∞, —á—Ç–æ `ac:{char_id}` —Å–æ–∑–¥–∞–µ—Ç—Å—è —Å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–º–∏ –ø–æ–ª—è–º–∏.

### 3. E2E Tests (User Flows)
*   **Focus:** –ü–æ–ª–Ω—ã–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (—ç–º—É–ª—è—Ü–∏—è –∑–∞–ø—Ä–æ—Å–æ–≤ –æ—Ç –±–æ—Ç–∞).

**–°—Ü–µ–Ω–∞—Ä–∏–∏:**
*   **Registration Flow:** `/start` -> User —Å–æ–∑–¥–∞–Ω –≤ –ë–î.
*   **New Player Flow:** Register -> Create Character -> Onboarding -> Login.
*   **Resume Flow:** Login -> Logout -> Login (–ø—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –ø–æ–∑–∏—Ü–∏–∏).

---

## üì± –ü–ª–∞–Ω –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è (Client)

### 1. Orchestrators (Unit)
*   **Focus:** –õ–æ–≥–∏–∫–∞ UI –∏ –≤—ã–∑–æ–≤—ã API.
*   **–ü—Ä–∏–Ω—Ü–∏–ø:** –ú–æ–∫–∞–µ–º `AccountClient`.

**–ö–µ–π—Å—ã:**
*   `test_lobby_render`: –ü—Ä–∏ –ø–æ–ª—É—á–µ–Ω–∏–∏ —Å–ø–∏—Å–∫–∞ –ø–µ—Ä—Å–æ–Ω–∞–∂–µ–π –æ—Ç API -> –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è `LobbyUI.render_menu`.
*   `test_create_character_flow`: –ü—Ä–∏ –≤—ã–∑–æ–≤–µ `handle_create` -> –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è API `create_character` -> –ø–µ—Ä–µ—Ö–æ–¥ –≤ Onboarding.

### 2. UI Components (Snapshot/Unit)
*   **Focus:** –ö–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç—å —Ç–µ–∫—Å—Ç–∞ –∏ –∫–Ω–æ–ø–æ–∫.

**–ö–µ–π—Å—ã:**
*   `test_lobby_keyboard_structure`: –ü—Ä–æ–≤–µ—Ä–∫–∞, —á—Ç–æ –∫–Ω–æ–ø–∫–∏ –ø–µ—Ä—Å–æ–Ω–∞–∂–µ–π —Å–æ–∑–¥–∞—é—Ç—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ (callback_data —Å–æ–¥–µ—Ä–∂–∏—Ç –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π ID).
*   `test_onboarding_step_render`: –ü—Ä–æ–≤–µ—Ä–∫–∞, —á—Ç–æ —Ç–µ–∫—Å—Ç —à–∞–≥–∞ –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è –±–µ–∑ –∏—Å–∫–∞–∂–µ–Ω–∏–π.
