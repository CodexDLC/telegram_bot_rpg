# üìú Log Builder (–ì–µ–Ω–µ—Ä–∞—Ç–æ—Ä –õ–æ–≥–æ–≤)

**Class:** `CombatLogBuilder`
**Path:** `apps.game_core.modules.combat.combat_engine.logic.log_builder`
**Type:** Stateless Logic Service
**Status:** üöß Planned (v3.0)

## üéØ –û—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç—å

–ü—Ä–µ–≤—Ä–∞—â–∞–µ—Ç —Å—É—Ö–∏–µ —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–∞–Ω–Ω—ã–µ –±–æ—è (`InteractionResultDTO`) –≤ –∫—Ä–∞—Å–∏–≤—ã–π, —Ö—É–¥–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–π —Ç–µ–∫—Å—Ç –¥–ª—è –∏–≥—Ä–æ–∫–∞.
–û—Ç–≤–µ—á–∞–µ—Ç –∑–∞ "–Ω–∞—Ä—Ä–∞—Ç–∏–≤" –±–æ—è, –ø–æ–¥–±–∏—Ä–∞—è –æ–ø–∏—Å–∞–Ω–∏—è –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞:
- **–ö—Ç–æ** –≤—ã–ø–æ–ª–Ω–∏–ª –¥–µ–π—Å—Ç–≤–∏–µ (–∏ –µ–≥–æ —Ç–∏–ø: humanoid, dragon, undead...)
- **–ß—Ç–æ** –±—ã–ª–æ —Å–¥–µ–ª–∞–Ω–æ (ability/feint ID)
- **–ö–∞–∫–æ–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç** (hit, crit, dodge, miss...)

---

## üìö –ë–∏–±–ª–∏–æ—Ç–µ–∫–∞ –¢–µ–∫—Å—Ç–æ–≤ (Flavor Library)

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ö—Ä–∞–Ω–µ–Ω–∏—è

–ë–∏–±–ª–∏–æ—Ç–µ–∫–∞ —Ç–µ–∫—Å—Ç–æ–≤ ‚Äî —ç—Ç–æ **–ø–ª–æ—Å–∫–∏–π —Å–ª–æ–≤–∞—Ä—å**, –≥–¥–µ:
- **–ö–ª—é—á** = ID –¥–µ–π—Å—Ç–≤–∏—è (`ability_id` / `feint_id` / `effect_id`)
- **–ó–Ω–∞—á–µ–Ω–∏–µ** = –°–ª–æ–≤–∞—Ä—å —Ç–µ–∫—Å—Ç–æ–≤, —Ä–∞–∑–±–∏—Ç—ã–π –ø–æ **outcomes** ‚Üí **family_types** ‚Üí —Å–ø–∏—Å–∫–∏ –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤

```python
FLAVOR_LIBRARY = {
    "fireball": {
        "cast": {
            "humanoid": ["–ú–∞–≥ –ø—Ä–æ–∏–∑–Ω–æ—Å–∏—Ç –∑–∞–∫–ª–∏–Ω–∞–Ω–∏–µ...", "–í–æ–ª—à–µ–±–Ω–∏–∫ —à–µ–ø—á–µ—Ç —Å–ª–æ–≤–∞ —Å–∏–ª—ã..."],
            "dragon": ["–î—Ä–∞–∫–æ–Ω –Ω–∞–±–∏—Ä–∞–µ—Ç –≤–æ–∑–¥—É—Ö –≤ –≥—Ä—É–¥—å...", "–ì–ª–æ—Ç–∫–∞ –¥—Ä–∞–∫–æ–Ω–∞ —Ä–∞—Å–∫–∞–ª–µ–Ω–∞ –¥–æ–∫—Ä–∞—Å–Ω–∞..."]
        },
        "hit": {
            "humanoid": ["–û–≥–Ω–µ–Ω–Ω—ã–π —à–∞—Ä –ø–æ—Ä–∞–∂–∞–µ—Ç {target}!", "–ü–ª–∞–º—è –æ–∫—É—Ç—ã–≤–∞–µ—Ç {target}!"],
            "dragon": ["–û–≥–Ω–µ–Ω–Ω–æ–µ –¥—ã—Ö–∞–Ω–∏–µ –æ–±—Ä—É—à–∏–≤–∞–µ—Ç—Å—è –Ω–∞ {target}!", "–ü–æ—Ç–æ–∫ –ø–ª–∞–º–µ–Ω–∏ –≤—ã–∂–∏–≥–∞–µ—Ç {target}!"]
        },
        "crit": {
            "humanoid": ["–í–∑—Ä—ã–≤ –ø–ª–∞–º–µ–Ω–∏ –∏—Å–ø–µ–ø–µ–ª—è–µ—Ç {target}!", "–û–≥–æ–Ω—å —Ä–µ–≤—ë—Ç, —Å–∂–∏–≥–∞—è {target}!"],
            "dragon": ["–ò—Å–ø–µ–ø–µ–ª—è—é—â–∏–π –æ–≥–æ–Ω—å –ø—Ä–µ–≤—Ä–∞—â–∞–µ—Ç {target} –≤ –ø–µ–ø–µ–ª!", "–ê–¥—Å–∫–æ–µ –ø–ª–∞–º—è –ø–æ–≥–ª–æ—â–∞–µ—Ç {target}!"]
        },
        "miss": {
            "humanoid": ["–û–≥–Ω–µ–Ω–Ω—ã–π —à–∞—Ä –ø—Ä–æ–ª–µ—Ç–∞–µ—Ç –º–∏–º–æ!", "–ü–ª–∞–º—è —Ä–∞—Å—Å–µ–∏–≤–∞–µ—Ç—Å—è –≤ –≤–æ–∑–¥—É—Ö–µ!"],
            "dragon": ["–°—Ç—Ä—É—è –æ–≥–Ω—è –ø—Ä–æ—Ö–æ–¥–∏—Ç –º–∏–º–æ!", "–î—Ä–∞–∫–æ–Ω –Ω–µ –ø–æ–ø–∞–¥–∞–µ—Ç –¥—ã—Ö–∞–Ω–∏–µ–º!"]
        },
        "dodge": {
            "humanoid": ["{target} —É–∫–ª–æ–Ω—è–µ—Ç—Å—è –æ—Ç –æ–≥–Ω–µ–Ω–Ω–æ–≥–æ —à–∞—Ä–∞!"],
            "dragon": ["{target} –æ—Ç–ø—Ä—ã–≥–∏–≤–∞–µ—Ç –æ—Ç –æ–≥–Ω–µ–Ω–Ω–æ–≥–æ –¥—ã—Ö–∞–Ω–∏—è!"]
        },
        "block": {
            "humanoid": ["{target} –±–ª–æ–∫–∏—Ä—É–µ—Ç –ø–ª–∞–º—è —â–∏—Ç–æ–º!"],
            "dragon": ["{target} —É–∫—Ä—ã–≤–∞–µ—Ç—Å—è –æ—Ç –æ–≥–Ω–µ–Ω–Ω–æ–≥–æ –¥—ã—Ö–∞–Ω–∏—è!"]
        },
        "parry": {
            "humanoid": ["{target} –æ—Ç–±–∏–≤–∞–µ—Ç –æ–≥–Ω–µ–Ω–Ω—ã–π —à–∞—Ä!"],
            "dragon": ["{target} —Ä–∞—Å—Å–µ–∏–≤–∞–µ—Ç –æ–≥–æ–Ω—å –∫—Ä—ã–ª–æ–º!"]
        }
    },

    "leg_sweep": {
        "cast": {
            "humanoid": ["–ë–æ–µ—Ü —Ä–∞–∑–≤–æ—Ä–∞—á–∏–≤–∞–µ—Ç—Å—è —Å –∞–ª–µ–±–∞—Ä–¥–æ–π...", "{source} –∑–∞–º–∞—Ö–∏–≤–∞–µ—Ç—Å—è –æ—Ä—É–∂–∏–µ–º..."],
            "dragon": ["–î—Ä–∞–∫–æ–Ω –∑–∞–º–∞—Ö–∏–≤–∞–µ—Ç—Å—è —Ö–≤–æ—Å—Ç–æ–º...", "–ú–æ—â–Ω—ã–π —Ö–≤–æ—Å—Ç –≥–æ—Ç–æ–≤–∏—Ç—Å—è –∫ —É–¥–∞—Ä—É..."]
        },
        "hit": {
            "humanoid": ["–£–¥–∞—Ä –ø–æ –Ω–æ–≥–∞–º —Å–±–∏–≤–∞–µ—Ç {target} —Å –Ω–æ–≥!", "–ü–æ–¥—Å–µ—á–∫–∞ –≤–∞–ª–∏—Ç {target} –Ω–∞–∑–µ–º—å!"],
            "dragon": ["–•–≤–æ—Å—Ç —Å–º–µ—Ç–∞–µ—Ç {target} —Å –Ω–æ–≥!", "–£–¥–∞—Ä —Ö–≤–æ—Å—Ç–æ–º —Å–±–∏–≤–∞–µ—Ç {target}!"]
        },
        "crit": {
            "humanoid": ["–ú–æ—â–Ω—ã–π —É–¥–∞—Ä –ª–æ–º–∞–µ—Ç {target} –Ω–æ–≥–∏!"],
            "dragon": ["–•–≤–æ—Å—Ç —Å —Ç—Ä–µ—Å–∫–æ–º —Å–±–∏–≤–∞–µ—Ç {target}!"]
        },
        "miss": {
            "humanoid": ["{target} –ø–µ—Ä–µ–ø—Ä—ã–≥–∏–≤–∞–µ—Ç —á–µ—Ä–µ–∑ —É–¥–∞—Ä!"],
            "dragon": ["{target} —É–≤–µ—Ä–Ω—É–ª—Å—è –æ—Ç —Ö–≤–æ—Å—Ç–∞!"]
        },
        "dodge": {
            "humanoid": ["{target} –æ—Ç—Å–∫–∞–∫–∏–≤–∞–µ—Ç –≤ —Å—Ç–æ—Ä–æ–Ω—É!"],
            "dragon": ["{target} –≤–∑–ª–µ—Ç–∞–µ—Ç, –∏–∑–±–µ–≥–∞—è —Ö–≤–æ—Å—Ç–∞!"]
        }
    }
}
```

### Outcomes (–ò—Å—Ö–æ–¥—ã)

–ü–æ–ª–Ω—ã–π —Å–ø–∏—Å–æ–∫ –≤–æ–∑–º–æ–∂–Ω—ã—Ö –∏—Å—Ö–æ–¥–æ–≤ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è (–∏–∑ `CombatResolver` –∏ `InteractionResultDTO`):

| Outcome | –û–ø–∏—Å–∞–Ω–∏–µ | –§–ª–∞–≥ –≤ DTO |
|---------|----------|------------|
| `cast` | –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏ (–Ω–∞—á–∞–ª–æ –¥–µ–π—Å—Ç–≤–∏—è) | - |
| `miss` | –ü—Ä–æ–º–∞—Ö (–Ω–µ –ø–æ–ø–∞–ª) | `is_miss` |
| `dodge` | –£–∫–ª–æ–Ω–µ–Ω–∏–µ –∑–∞—â–∏—Ç–Ω–∏–∫–∞ | `is_dodged` |
| `parry` | –ü–∞—Ä–∏—Ä–æ–≤–∞–Ω–∏–µ –∑–∞—â–∏—Ç–Ω–∏–∫–∞ | `is_parried` |
| `block` | –ë–ª–æ–∫ —â–∏—Ç–æ–º | `is_blocked` |
| `hit` | –û–±—ã—á–Ω–æ–µ –ø–æ–ø–∞–¥–∞–Ω–∏–µ | `is_hit` |
| `crit` | –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–π —É–¥–∞—Ä | `is_crit + is_hit` |
| `counter` | –ö–æ–Ω—Ç—Ä–∞—Ç–∞–∫–∞ | `is_counter` |
| `heal` | –ò—Å—Ü–µ–ª–µ–Ω–∏–µ | `healing_final > 0` |
| `reflect` | –û—Ç—Ä–∞–∂–µ–Ω–∏–µ —É—Ä–æ–Ω–∞ | `reflected_damage > 0` |

### Family Types (–¢–∏–ø—ã —Å—É—â–µ—Å—Ç–≤)

–¢–∏–ø—ã —Å—É—â–µ—Å—Ç–≤ –æ–ø—Ä–µ–¥–µ–ª—è—é—Ç **–∫–∞–∫** –ø–µ—Ä—Å–æ–Ω–∞–∂ –≤—ã–ø–æ–ª–Ω—è–µ—Ç –¥–µ–π—Å—Ç–≤–∏–µ.

**–ë–∞–∑–æ–≤—ã–µ —Ç–∏–ø—ã:**
- `humanoid` - –≥—É–º–∞–Ω–æ–∏–¥—ã (–∏–≥—Ä–æ–∫–∏, –æ—Ä–∫–∏, –ª—é–¥–∏, —ç–ª—å—Ñ—ã...)
- `dragon` - –¥—Ä–∞–∫–æ–Ω—ã –∏ –¥—Ä–∞–∫–æ–Ω–æ–ø–æ–¥–æ–±–Ω—ã–µ
- `undead` - –Ω–µ–∂–∏—Ç—å
- `beast` - –∑–≤–µ—Ä–∏, –∂–∏–≤–æ—Ç–Ω—ã–µ
- `construct` - –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç—ã, –≥–æ–ª–µ–º—ã
- `elemental` - —ç–ª–µ–º–µ–Ω—Ç–∞–ª–∏

**–ü—Ä–∞–≤–∏–ª–∞:**
1. –ö–∞–∂–¥—ã–π –º–æ–Ω—Å—Ç—Ä/–ø–µ—Ä—Å–æ–Ω–∞–∂ –∏–º–µ–µ—Ç `family_type` –≤ —Å–≤–æ–∏—Ö –¥–∞–Ω–Ω—ã—Ö
2. –ï—Å–ª–∏ –¥–ª—è `family_type` –Ω–µ—Ç —Ç–µ–∫—Å—Ç–∞ ‚Äî –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è `humanoid` –∫–∞–∫ fallback
3. –î–ª—è abilities/feints –º–æ–∂–Ω–æ –Ω–µ —Å–æ–∑–¥–∞–≤–∞—Ç—å —Ç–µ–∫—Å—Ç—ã –¥–ª—è –≤—Å–µ—Ö —Ç–∏–ø–æ–≤ —Å—Ä–∞–∑—É ‚Äî —Ç–æ–ª—å–∫–æ –¥–ª—è —Ç–µ—Ö, –∫—Ç–æ –∏—Ö –∏—Å–ø–æ–ª—å–∑—É–µ—Ç

### –ü–ª–µ–π—Å—Ö–æ–ª–¥–µ—Ä—ã (Placeholders)

–î–æ—Å—Ç—É–ø–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –¥–ª—è –ø–æ–¥—Å—Ç–∞–Ω–æ–≤–∫–∏ –≤ —Ç–µ–∫—Å—Ç—ã:

| Placeholder | –û–ø–∏—Å–∞–Ω–∏–µ | –ü—Ä–∏–º–µ—Ä |
|-------------|----------|--------|
| `{source}` | –ò–º—è –∞—Ç–∞–∫—É—é—â–µ–≥–æ | "–ì—ç–Ω–¥–∞–ª—å—Ñ" |
| `{target}` | –ò–º—è –∑–∞—â–∏—Ç–Ω–∏–∫–∞ | "–û—Ä–∫" |
| `{value}` | –ó–Ω–∞—á–µ–Ω–∏–µ —É—Ä–æ–Ω–∞/–∏—Å—Ü–µ–ª–µ–Ω–∏—è | "50" |
| `{icon}` | –ò–∫–æ–Ω–∫–∞ –¥–µ–π—Å—Ç–≤–∏—è | "üî•" |

### –û—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏—è —Ñ–∞–π–ª–æ–≤

–ë–∏–±–ª–∏–æ—Ç–µ–∫–∞ —Ä–∞–∑–±–∏—Ç–∞ –Ω–∞ —Ñ–∞–π–ª—ã –¥–ª—è —É–¥–æ–±—Å—Ç–≤–∞ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏:

```
apps/game_core/resources/game_data/flavor_texts/
‚îú‚îÄ‚îÄ abilities/
‚îÇ   ‚îú‚îÄ‚îÄ fireball.py
‚îÇ   ‚îú‚îÄ‚îÄ heal.py
‚îÇ   ‚îî‚îÄ‚îÄ shield_bash.py
‚îú‚îÄ‚îÄ feints/
‚îÇ   ‚îú‚îÄ‚îÄ leg_sweep.py
‚îÇ   ‚îú‚îÄ‚îÄ sand_throw.py
‚îÇ   ‚îî‚îÄ‚îÄ disarm.py
‚îú‚îÄ‚îÄ effects/
‚îÇ   ‚îú‚îÄ‚îÄ burn.py
‚îÇ   ‚îú‚îÄ‚îÄ bleed.py
‚îÇ   ‚îî‚îÄ‚îÄ stun.py
‚îî‚îÄ‚îÄ __init__.py  # –°–æ–±–∏—Ä–∞–µ—Ç –≤—Å–µ –≤ –ø–ª–æ—Å–∫–∏–π FLAVOR_LIBRARY
```

**–ü—Ä–∏–º–µ—Ä —Ñ–∞–π–ª–∞ (`fireball.py`):**
```python
FIREBALL_TEXTS = {
    "cast": {
        "humanoid": ["–ú–∞–≥ –ø—Ä–æ–∏–∑–Ω–æ—Å–∏—Ç –∑–∞–∫–ª–∏–Ω–∞–Ω–∏–µ...", "–í–æ–ª—à–µ–±–Ω–∏–∫ —à–µ–ø—á–µ—Ç —Å–ª–æ–≤–∞ —Å–∏–ª—ã..."],
        "dragon": ["–î—Ä–∞–∫–æ–Ω –Ω–∞–±–∏—Ä–∞–µ—Ç –≤–æ–∑–¥—É—Ö –≤ –≥—Ä—É–¥—å...", "–ì–ª–æ—Ç–∫–∞ –¥—Ä–∞–∫–æ–Ω–∞ —Ä–∞—Å–∫–∞–ª–µ–Ω–∞ –¥–æ–∫—Ä–∞—Å–Ω–∞..."]
    },
    "hit": {
        "humanoid": ["–û–≥–Ω–µ–Ω–Ω—ã–π —à–∞—Ä –ø–æ—Ä–∞–∂–∞–µ—Ç {target}!", "–ü–ª–∞–º—è –æ–∫—É—Ç—ã–≤–∞–µ—Ç {target}!"],
        "dragon": ["–û–≥–Ω–µ–Ω–Ω–æ–µ –¥—ã—Ö–∞–Ω–∏–µ –æ–±—Ä—É—à–∏–≤–∞–µ—Ç—Å—è –Ω–∞ {target}!", "–ü–æ—Ç–æ–∫ –ø–ª–∞–º–µ–Ω–∏ –≤—ã–∂–∏–≥–∞–µ—Ç {target}!"]
    },
    # ... –æ—Å—Ç–∞–ª—å–Ω—ã–µ outcomes
}
```

**–ü—Ä–∏–º–µ—Ä `__init__.py`:**
```python
from .abilities.fireball import FIREBALL_TEXTS
from .abilities.heal import HEAL_TEXTS
from .feints.leg_sweep import LEG_SWEEP_TEXTS

FLAVOR_LIBRARY = {
    "fireball": FIREBALL_TEXTS,
    "heal": HEAL_TEXTS,
    "leg_sweep": LEG_SWEEP_TEXTS,
    # ...
}
```

---

## ‚öôÔ∏è –ü—Ä–∏–Ω—Ü–∏–ø —Ä–∞–±–æ—Ç—ã LogBuilder

### 1. –í—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ

–ù–∞ –≤—Ö–æ–¥ –ø–æ—Å—Ç—É–ø–∞–µ—Ç `InteractionResultDTO` —Å —Å–æ–±—ã—Ç–∏—è–º–∏:

```python
result = InteractionResultDTO(
    source_id=1,
    target_id=2,
    is_hit=True,
    is_crit=True,
    damage_final=50,
    events=[
        CombatEventDTO(type="HIT", source_id=1, target_id=2, value=50, tags=["CRIT"])
    ]
)
```

### 2. –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ Outcome

LogBuilder –∞–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç —Ñ–ª–∞–≥–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞:

```python
def _determine_outcome(result: InteractionResultDTO) -> str:
    if result.is_miss:
        return "miss"
    if result.is_dodged:
        return "dodge"
    if result.is_parried:
        return "parry"
    if result.is_blocked:
        return "block"
    if result.is_crit:
        return "crit"
    if result.is_hit:
        return "hit"
    if result.healing_final > 0:
        return "heal"
    return "cast"
```

### 3. –ü–æ–ª—É—á–µ–Ω–∏–µ Family Type

–ë–µ—Ä—ë—Ç—Å—è –∏–∑ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã—Ö –∞–∫—Ç–æ—Ä–∞:

```python
source_actor = context.actors[result.source_id]
family_type = source_actor.meta.family_type  # "humanoid", "dragon", etc.
```

### 4. –í—ã–±–æ—Ä —Ç–µ–∫—Å—Ç–∞

```python
action_id = context.action_id  # "fireball"
outcome = _determine_outcome(result)  # "crit"

# –ü–æ–ª—É—á–∞–µ–º –±–∏–±–ª–∏–æ—Ç–µ–∫—É –¥–ª—è –¥–µ–π—Å—Ç–≤–∏—è
action_texts = FLAVOR_LIBRARY.get(action_id)
if not action_texts:
    return f"{source_name} –∏—Å–ø–æ–ª—å–∑—É–µ—Ç {action_id}"  # Fallback

# –ü–æ–ª—É—á–∞–µ–º —Ç–µ–∫—Å—Ç—ã –¥–ª—è outcome
outcome_texts = action_texts.get(outcome, action_texts.get("hit", {}))

# –ü–æ–ª—É—á–∞–µ–º —Ç–µ–∫—Å—Ç—ã –¥–ª—è family_type
family_texts = outcome_texts.get(family_type, outcome_texts.get("humanoid", []))

# –í—ã–±–∏—Ä–∞–µ–º —Å–ª—É—á–∞–π–Ω—ã–π –≤–∞—Ä–∏–∞–Ω—Ç
if family_texts:
    template = random.choice(family_texts)
else:
    template = f"{{source}} –∞—Ç–∞–∫—É–µ—Ç {{target}}"  # Fallback
```

### 5. –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

```python
text = template.format(
    source=source_actor.meta.name,
    target=target_actor.meta.name,
    value=result.damage_final
)

# –†–µ–∑—É–ª—å—Ç–∞—Ç: "–í–∑—Ä—ã–≤ –ø–ª–∞–º–µ–Ω–∏ –∏—Å–ø–µ–ø–µ–ª—è–µ—Ç –û—Ä–∫!"
```

### 6. –°–æ–∑–¥–∞–Ω–∏–µ CombatLogEntryDTO

```python
log_entry = CombatLogEntryDTO(
    text=text,
    timestamp=time.time(),
    tags=["combat", "ability", action_id, outcome]
)
```

---

## üì¶ –¢–∏–ø—ã –ª–æ–≥–æ–≤

–õ–æ–≥ –±–æ—è —Å–æ—Å—Ç–æ–∏—Ç –∏–∑ –∑–∞–ø–∏—Å–µ–π —Ä–∞–∑–Ω—ã—Ö —Ç–∏–ø–æ–≤:

### 1. Action Log (–î–µ–π—Å—Ç–≤–∏–µ)
```
üßô‚Äç‚ôÇÔ∏è –ì—ç–Ω–¥–∞–ª—å—Ñ –∫–∞—Å—Ç—É–µ—Ç –û–≥–Ω–µ–Ω–Ω—ã–π –®–∞—Ä!
üî• –û–≥–Ω–µ–Ω–Ω—ã–π —à–∞—Ä –ø–æ—Ä–∞–∂–∞–µ—Ç –û—Ä–∫–∞! (50 —É—Ä–æ–Ω–∞)
‚ò†Ô∏è –û—Ä–∫ –∑–∞–≥–æ—Ä–∞–µ—Ç—Å—è.
```

### 2. Mechanics Log (–¢–∏–∫–∏ —ç—Ñ—Ñ–µ–∫—Ç–æ–≤)
```
ü©∏ –ò–≥—Ä–æ–∫ —Ç–µ—Ä—è–µ—Ç 5 HP –æ—Ç –ö—Ä–æ–≤–æ—Ç–µ—á–µ–Ω–∏—è.
‚ú® –ò–≥—Ä–æ–∫ –≤–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç 10 HP.
```

### 3. Death Log (–°–º–µ—Ä—Ç—å)
```
üíÄ –û—Ä–∫ –ø–æ–≥–∏–±–∞–µ—Ç!
```

### 4. Turn Separator
```
‚ïê‚ïê‚ïê –•–æ–¥ 5 ‚ïê‚ïê‚ïê
```

---

## üõ†Ô∏è Integration

```python
# –í Executor –ø–æ—Å–ª–µ —Ä–∞—Å—á—ë—Ç–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞
def _process_result(self, result: InteractionResultDTO, context: BattleContext):
    # ... –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ —É—Ä–æ–Ω–∞, —ç—Ñ—Ñ–µ–∫—Ç–æ–≤ ...

    # –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –ª–æ–≥–∞
    log_entry = LogBuilder.build_action_log(
        action_id=context.action_id,
        result=result,
        source=context.actors[result.source_id],
        target=context.actors[result.target_id]
    )

    # –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ –∏—Å—Ç–æ—Ä–∏—é
    context.logs.append(log_entry.model_dump_json())
```

---

## ‚úÖ –í–∞–ª–∏–¥–∞—Ü–∏—è –±–∏–±–ª–∏–æ—Ç–µ–∫–∏

–°–∫—Ä–∏–ø—Ç `scripts/validate_flavor_library.py` –ø—Ä–æ–≤–µ—Ä—è–µ—Ç:

1. –í—Å–µ –º–æ–Ω—Å—Ç—Ä—ã –∏–º–µ—é—Ç `family_type`
2. –î–ª—è –∫–∞–∂–¥–æ–≥–æ ability/feint –º–æ–Ω—Å—Ç—Ä–∞ –µ—Å—Ç—å –∑–∞–ø–∏—Å—å –≤ `FLAVOR_LIBRARY`
3. –î–ª—è `family_type` –º–æ–Ω—Å—Ç—Ä–∞ –µ—Å—Ç—å —Ç–µ–∫—Å—Ç—ã –≤–æ –≤—Å–µ—Ö –∏—Å–ø–æ–ª—å–∑—É–µ–º—ã—Ö ability/feint
4. –ù–µ—Ç –ø—Ä–æ–ø—É—â–µ–Ω–Ω—ã—Ö outcomes –¥–ª—è –∫—Ä–∏—Ç–∏—á–Ω—ã—Ö –¥–µ–π—Å—Ç–≤–∏–π

**–ü—Ä–∏–º–µ—Ä –∑–∞–ø—É—Å–∫–∞:**
```bash
python scripts/validate_flavor_library.py
```

**–ü—Ä–∏–º–µ—Ä –≤—ã–≤–æ–¥–∞:**
```
‚úÖ fireball: OK (humanoid, dragon)
‚ö†Ô∏è leg_sweep: Missing texts for family_type 'undead' (used by Skeleton Warrior)
‚ùå heal: Missing in FLAVOR_LIBRARY (used by Cleric)
```
