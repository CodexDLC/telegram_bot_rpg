# üß™ Arena Testing Strategy

[‚¨ÖÔ∏è –ù–∞–∑–∞–¥: Arena Manifest](../Manifest.md)

## ü§ñ AI CONTEXT
–°—Ç—Ä–∞—Ç–µ–≥–∏—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –¥–ª—è –¥–æ–º–µ–Ω–∞ Arena.

## üîó –°—Ç–∞–Ω–¥–∞—Ä—Ç
–≠—Ç–æ—Ç –¥–æ–∫—É–º–µ–Ω—Ç —Å–ª–µ–¥—É–µ—Ç –æ–±—â–µ–º—É —Å—Ç–∞–Ω–¥–∞—Ä—Ç—É —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –ø—Ä–æ–µ–∫—Ç–∞:
> `docs/management/Standards/Testing_Standard.md` (TODO: —Å–æ–∑–¥–∞—Ç—å)

## üìã –¢–∏–ø—ã —Ç–µ—Å—Ç–æ–≤

### Unit Tests
**–¶–µ–ª—å:** –ü—Ä–æ–≤–µ—Ä–∫–∞ –æ—Ç–¥–µ–ª—å–Ω—ã—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤ –≤ –∏–∑–æ–ª—è—Ü–∏–∏.
**–†–∞—Å–ø–æ–ª–æ–∂–µ–Ω–∏–µ:** `tests/unit/arena/`

| –ö–æ–º–ø–æ–Ω–µ–Ω—Ç | –ß—Ç–æ —Ç–µ—Å—Ç–∏—Ä—É–µ–º |
| :--- | :--- |
| `ArenaService` | –õ–æ–≥–∏–∫–∞ `check_match` (—Ç–∞–π–º–∞—É—Ç, –ø–æ–∏—Å–∫), –≥–µ–Ω–µ—Ä–∞—Ü–∏—è DTO |
| `ArenaSessionService` | –ü—Ä–∞–≤–∏–ª—å–Ω–æ—Å—Ç—å –≤—ã–∑–æ–≤–æ–≤ Redis managers |
| `ArenaGateway` | –†–æ—É—Ç–∏–Ω–≥ `action` –Ω–∞ –º–µ—Ç–æ–¥—ã Service |
| `ArenaResources` | –ö–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç—å —Ç–µ–∫—Å—Ç–æ–≤ –∏ –∫–Ω–æ–ø–æ–∫ |

### Integration Tests
**–¶–µ–ª—å:** –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤.
**–†–∞—Å–ø–æ–ª–æ–∂–µ–Ω–∏–µ:** `tests/integration/arena/`

| –°—Ü–µ–Ω–∞—Ä–∏–π | –ß—Ç–æ —Ç–µ—Å—Ç–∏—Ä—É–µ–º |
| :--- | :--- |
| Full Flow 1v1 | `join_queue` ‚Üí `check_match` (–Ω–∞–π–¥–µ–Ω) ‚Üí `_create_battle` |
| Shadow Flow | `join_queue` ‚Üí `check_match` (—Ç–∞–π–º–∞—É—Ç) ‚Üí `_create_battle` (shadow) |
| Cancel Flow | `join_queue` ‚Üí `cancel_queue` ‚Üí –ø—Ä–æ–≤–µ—Ä–∫–∞ –æ—á–∏—Å—Ç–∫–∏ Redis |

### E2E Tests
**–¶–µ–ª—å:** –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–ª–Ω–æ–≥–æ –ø—É—Ç–∏ –æ—Ç –∫–ª–∏–µ–Ω—Ç–∞ –¥–æ backend.
**–†–∞—Å–ø–æ–ª–æ–∂–µ–Ω–∏–µ:** `tests/e2e/`

| –°—Ü–µ–Ω–∞—Ä–∏–π | –ß—Ç–æ —Ç–µ—Å—Ç–∏—Ä—É–µ–º |
| :--- | :--- |
| Happy Path 1v1 | –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–∞–∂–∏–º–∞–µ—Ç –∫–Ω–æ–ø–∫—É ‚Üí Polling ‚Üí –ú–∞—Ç—á –Ω–∞–π–¥–µ–Ω ‚Üí –ü–µ—Ä–µ—Ö–æ–¥ –≤ –±–æ–π |
| Cancel Path | –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–∞–∂–∏–º–∞–µ—Ç "–û—Ç–º–µ–Ω–∞" ‚Üí Polling –æ—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è |

## üîß –ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã
*   **Pytest:** –û—Å–Ω–æ–≤–Ω–æ–π —Ñ—Ä–µ–π–º–≤–æ—Ä–∫
*   **Fakeredis:** –ú–æ–∫ Redis –¥–ª—è Unit —Ç–µ—Å—Ç–æ–≤
*   **HTTPX:** –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ API
*   **TestClient (FastAPI):** –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ FastAPI –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è