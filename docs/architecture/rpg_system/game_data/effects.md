# Status Effects (–°—Ç–∞—Ç—É—Å–Ω—ã–µ —ç—Ñ—Ñ–µ–∫—Ç—ã)

## üìã –û–±–∑–æ—Ä

–°—Ç–∞—Ç—É—Å–Ω—ã–µ —ç—Ñ—Ñ–µ–∫—Ç—ã ‚Äî —ç—Ç–æ –≤—Ä–µ–º–µ–Ω–Ω—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è —Å–æ—Å—Ç–æ—è–Ω–∏—è –ø–µ—Ä—Å–æ–Ω–∞–∂–∞, –∫–æ—Ç–æ—Ä—ã–µ –º–æ–≥—É—Ç –Ω–∞–Ω–æ—Å–∏—Ç—å —É—Ä–æ–Ω, –ª–µ—á–∏—Ç—å, —É—Å–∏–ª–∏–≤–∞—Ç—å –∏–ª–∏ –æ—Å–ª–∞–±–ª—è—Ç—å —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏, –∞ —Ç–∞–∫–∂–µ –æ–≥—Ä–∞–Ω–∏—á–∏–≤–∞—Ç—å –¥–µ–π—Å—Ç–≤–∏—è (–∫–æ–Ω—Ç—Ä–æ–ª—å).

**–¢–∏–ø—ã —ç—Ñ—Ñ–µ–∫—Ç–æ–≤:**
- **DoT (Damage Over Time):** –ü–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–∏–π —É—Ä–æ–Ω (–ö—Ä–æ–≤–æ—Ç–µ—á–µ–Ω–∏–µ, –Ø–¥, –ì–æ—Ä–µ–Ω–∏–µ).
- **HoT (Heal Over Time):** –ü–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–æ–µ –ª–µ—á–µ–Ω–∏–µ (–†–µ–≥–µ–Ω–µ—Ä–∞—Ü–∏—è).
- **Buff (–ë–∞—Ñ—Ñ):** –í—Ä–µ–º–µ–Ω–Ω–æ–µ —É—Å–∏–ª–µ–Ω–∏–µ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫ (–Ø—Ä–æ—Å—Ç—å, –©–∏—Ç).
- **Debuff (–î–µ–±–∞—Ñ—Ñ):** –í—Ä–µ–º–µ–Ω–Ω–æ–µ –æ—Å–ª–∞–±–ª–µ–Ω–∏–µ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫ (–°–ª–∞–±–æ—Å—Ç—å, –ó–∞–º–µ–¥–ª–µ–Ω–∏–µ).
- **Control (–ö–æ–Ω—Ç—Ä–æ–ª—å):** –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –¥–µ–π—Å—Ç–≤–∏–π (–û–≥–ª—É—à–µ–Ω–∏–µ, –°–æ–Ω, –ö–æ—Ä–Ω–∏).

## ‚öôÔ∏è –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è

### Dynamic Scaling (–î–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–µ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ)

–≠—Ñ—Ñ–µ–∫—Ç—ã –º–æ–≥—É—Ç –±—ã—Ç—å —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–º–∏ (Flat) –∏–ª–∏ –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–º–∏ (Scaled).
–î–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–µ —ç—Ñ—Ñ–µ–∫—Ç—ã –∑–∞–≤–∏—Å—è—Ç –æ—Ç —Å–∏–ª—ã —É–¥–∞—Ä–∞ –∏–ª–∏ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫ –Ω–∞–ª–æ–∂–∏–≤—à–µ–≥–æ –∏—Ö –ø–µ—Ä—Å–æ–Ω–∞–∂–∞.

**Power Level:**
–í–º–µ—Å—Ç–æ –∂–µ—Å—Ç–∫–æ–≥–æ –ø—Ä–æ—Ü–µ–Ω—Ç–∞ –º—ã –∏—Å–ø–æ–ª—å–∑—É–µ–º —É—Ä–æ–≤–µ–Ω—å —Å–∏–ª—ã (`power`), –∫–æ—Ç–æ—Ä—ã–π –º–∞–ø–∏—Ç—Å—è –Ω–∞ –ø—Ä–æ—Ü–µ–Ω—Ç –æ—Ç –∏—Å—Ç–æ—á–Ω–∏–∫–∞ (Snapshot Damage).

| Power | Factor (% –æ—Ç —É—Ä–æ–Ω–∞) | –û–ø–∏—Å–∞–Ω–∏–µ |
| :--- | :--- | :--- |
| 1 | 0.10 (10%) | –õ–µ–≥–∫–∞—è —Ä–∞–Ω–∞ |
| 2 | 0.20 (20%) | –°—Ä–µ–¥–Ω—è—è —Ä–∞–Ω–∞ |
| 3 | 0.35 (35%) | –ì–ª—É–±–æ–∫–∞—è —Ä–∞–Ω–∞ |
| 4 | 0.50 (50%) | –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è —Ä–∞–Ω–∞ |
| 5 | 0.75 (75%) | –°–º–µ—Ä—Ç–µ–ª—å–Ω–∞—è —Ä–∞–Ω–∞ |

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ DTO

```python
from pydantic import BaseModel
from enum import Enum
from typing import Any

class EffectType(str, Enum):
    DOT = "dot"
    HOT = "hot"
    BUFF = "buff"
    DEBUFF = "debuff"
    CONTROL = "control"

class EffectDTO(BaseModel):
    effect_id: str              # –£–Ω–∏–∫–∞–ª—å–Ω—ã–π ID (–Ω–∞–ø—Ä–∏–º–µ—Ä, "bleed")
    name_en: str
    name_ru: str
    
    type: EffectType            # –¢–∏–ø —ç—Ñ—Ñ–µ–∫—Ç–∞
    duration: int               # –î–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –≤ —Ä–∞–∑–º–µ–Ω–∞—Ö (Exchange)
    
    # --- Impact Configuration ---
    # –§–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ (Legacy/Simple)
    impact_flat: dict[str, int] = {} 
    
    # –î–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–µ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ
    # –ï—Å–ª–∏ —É–∫–∞–∑–∞–Ω–æ, impact —Ä–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ—Ç—Å—è –≤ –º–æ–º–µ–Ω—Ç –Ω–∞–ª–æ–∂–µ–Ω–∏—è
    scaling: dict[str, Any] = {}
    # –ü—Ä–∏–º–µ—Ä:
    # {
    #   "source": "snapshot_damage",  # –û—Ç —á–µ–≥–æ —Å—á–∏—Ç–∞–µ–º (—É—Ä–æ–Ω —É–¥–∞—Ä–∞)
    #   "stat": "hp",                 # –ù–∞ —á—Ç–æ –≤–ª–∏—è–µ—Ç (–æ—Ç–Ω–∏–º–∞–µ—Ç HP)
    #   "power": 1                    # –£—Ä–æ–≤–µ–Ω—å —Å–∏–ª—ã (—Å–º. —Ç–∞–±–ª–∏—Ü—É)
    # }
    
    # –ú–æ–¥–∏—Ñ–∏–∫–∞—Ç–æ—Ä—ã —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫ (–¥–ª—è Buff/Debuff)
    modifiers: dict[str, Any] = {}
    
    # –§–ª–∞–≥–∏ —Å–æ—Å—Ç–æ—è–Ω–∏—è (–¥–ª—è Control)
    flags: dict[str, Any] = {}
    
    description: str
```

### –ü—Ä–∏–º–µ—Ä—ã –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏

#### DoT: Bleed (Dynamic)
–ó–∞–≤–∏—Å–∏—Ç –æ—Ç —Å–∏–ª—ã —É–¥–∞—Ä–∞.

```python
bleed_config = EffectDTO(
    effect_id="bleed",
    name_en="Bleeding",
    name_ru="–ö—Ä–æ–≤–æ—Ç–µ—á–µ–Ω–∏–µ",
    type=EffectType.DOT,
    duration=3,
    scaling={
        "source": "snapshot_damage",
        "stat": "hp",
        "power": 2  # 20% –æ—Ç –Ω–∞–Ω–µ—Å–µ–Ω–Ω–æ–≥–æ —É—Ä–æ–Ω–∞ –∫–∞–∂–¥—ã–π —Ö–æ–¥
    },
    description="–ì–ª—É–±–æ–∫–∞—è —Ä–∞–Ω–∞ –∫—Ä–æ–≤–æ—Ç–æ—á–∏—Ç, –Ω–∞–Ω–æ—Å—è —É—Ä–æ–Ω, –∑–∞–≤–∏—Å—è—â–∏–π –æ—Ç —Å–∏–ª—ã —É–¥–∞—Ä–∞."
)
```

#### DoT: Poison (Flat + Mod)
–§–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —É—Ä–æ–Ω + –¥–µ–±–∞—Ñ—Ñ.

```python
poison_config = EffectDTO(
    effect_id="poison",
    name_en="Poison",
    name_ru="–Ø–¥",
    type=EffectType.DOT,
    duration=5,
    impact_flat={"hp": -10},  # –§–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ 10 —É—Ä–æ–Ω–∞
    modifiers={
        "physical_resistance": {
            "temp": {"poison": "-0.1"}
        }
    },
    description="–Ø–¥ —Ä–∞–∑—ä–µ–¥–∞–µ—Ç –ø–ª–æ—Ç—å –∏ —Å–Ω–∏–∂–∞–µ—Ç –∑–∞—â–∏—Ç—É."
)
```

## üîå –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –≤ –±–æ–µ–≤—É—é —Å–∏—Å—Ç–µ–º—É

### Snapshotting (–°–Ω–∏–º–æ–∫ –º–æ–º–µ–Ω—Ç–∞)

–ö–æ–≥–¥–∞ —Å—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç —Ç—Ä–∏–≥–≥–µ—Ä (–Ω–∞–ø—Ä–∏–º–µ—Ä, –∫—Ä–∏—Ç –º–µ—á–æ–º), —Å–∏—Å—Ç–µ–º–∞ —Ä–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ—Ç —Å–∏–ª—É —ç—Ñ—Ñ–µ–∫—Ç–∞.

```python
# CombatResolver
if trigger.effect_id == "bleed":
    effect_config = get_effect_config("bleed")
    
    final_impact = {}
    
    # 1. –†–∞—Å—á–µ—Ç –¥–∏–Ω–∞–º–∏–∫–∏
    if effect_config.scaling:
        power_lvl = effect_config.scaling["power"]
        factor = POWER_TABLE[power_lvl]  # 0.2
        
        # –ë–µ—Ä–µ–º —É—Ä–æ–Ω, –∫–æ—Ç–æ—Ä—ã–π —Ç–æ–ª—å–∫–æ —á—Ç–æ –Ω–∞–Ω–µ—Å–ª–∏
        base_dmg = result.final_damage 
        
        val = int(base_dmg * factor)
        final_impact[effect_config.scaling["stat"]] = -val
        
    # 2. –î–æ–±–∞–≤–ª–µ–Ω–∏–µ —Ñ–∏–∫—Å—ã
    for k, v in effect_config.impact_flat.items():
        final_impact[k] = final_impact.get(k, 0) + v

    # 3. –ù–∞–ª–æ–∂–µ–Ω–∏–µ
    apply_effect(target, "bleed", impact=final_impact)
```
