# Game Data: Triggers (–¢—Ä–∏–≥–≥–µ—Ä—ã)

## üìã –û–±–∑–æ—Ä

–≠—Ç–æ—Ç —Ä–∞–∑–¥–µ–ª –æ–ø–∏—Å—ã–≤–∞–µ—Ç **—Ö—Ä–∞–Ω–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö** –¥–ª—è —Å–∏—Å—Ç–µ–º—ã —Ç—Ä–∏–≥–≥–µ—Ä–æ–≤.
–¢—Ä–∏–≥–≥–µ—Ä—ã ‚Äî —ç—Ç–æ –ø—Ä–∞–≤–∏–ª–∞, —Å–≤—è–∑—ã–≤–∞—é—â–∏–µ –∏–≥—Ä–æ–≤—ã–µ —Å–æ–±—ã—Ç–∏—è (–ö—Ä–∏—Ç, –£–¥–∞—Ä) —Å —ç—Ñ—Ñ–µ–∫—Ç–∞–º–∏ (–ö—Ä–æ–≤–æ—Ç–µ—á–µ–Ω–∏–µ, –°—Ç–∞–Ω).

---

## üîó –ù–∞–≤–∏–≥–∞—Ü–∏—è

*   **–ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç (–î–≤–∏–∂–æ–∫):** [Trigger System Spec](../../combat_system_v3/specs/components/features/trigger_system.md)
    *   –û–ø–∏—Å–∞–Ω–∏–µ –∞–ª–≥–æ—Ä–∏—Ç–º–∞ `CombatResolver`, —Ñ–ª–∞–≥–æ–≤ –∏ –º—É—Ç–∞—Ü–∏–π.
*   **–ì–µ–π–º–¥–∏–∑–∞–π–Ω (–û—Ä—É–∂–∏–µ):** [Weapon Triggers](../items/weapon_triggers.md)
    *   –û–ø–∏—Å–∞–Ω–∏–µ –º–µ—Ö–∞–Ω–∏–∫ –¥–ª—è –º–µ—á–µ–π, –ª—É–∫–æ–≤, –±—É–ª–∞–≤ –∏ —Ç.–¥.

---

## üìÇ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ñ–∞–π–ª–æ–≤ (Codebase)

–î–∞–Ω–Ω—ã–µ —Ç—Ä–∏–≥–≥–µ—Ä–æ–≤ —Ö—Ä–∞–Ω—è—Ç—Å—è –≤ –º–æ–¥—É–ª–µ `apps/game_core/resources/game_data/triggers/`.

```
apps/game_core/resources/game_data/triggers/
‚îú‚îÄ‚îÄ definitions/           # –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã—Ö —Ç—Ä–∏–≥–≥–µ—Ä–æ–≤
‚îÇ   ‚îú‚îÄ‚îÄ weapon_triggers.py # –¢—Ä–∏–≥–≥–µ—Ä—ã –æ—Ä—É–∂–∏—è (bleed, stun)
‚îÇ   ‚îî‚îÄ‚îÄ ...
‚îú‚îÄ‚îÄ schemas.py             # DTO (TriggerData)
‚îú‚îÄ‚îÄ registry.py            # –†–µ–µ—Å—Ç—Ä (TRIGGER_REGISTRY)
‚îî‚îÄ‚îÄ rules.py               # –ü—Ä–∞–≤–∏–ª–∞ –¥–ª—è —Ä–µ–∑–æ–ª–≤–µ—Ä–∞ (TRIGGER_RULES)
```

---

## üèóÔ∏è –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–∞–Ω–Ω—ã—Ö

### 1. TriggerData (DTO)
–û–ø–∏—Å—ã–≤–∞–µ—Ç –æ–¥–∏–Ω —Ç—Ä–∏–≥–≥–µ—Ä –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö.

```python
class TriggerData(BaseModel):
    id: str                 # "trigger_bleed"
    name_ru: str            # "–ö—Ä–æ–≤–æ—Ç–µ—á–µ–Ω–∏–µ"
    event: str              # "ON_CRIT", "ON_HIT"
    chance: float = 1.0     # 1.0 = 100%
    effect: str             # "apply_bleed" (–∫–ª—é—á –¥–ª—è AbilityService)
    metadata: dict          # –ü–∞—Ä–∞–º–µ—Ç—Ä—ã —ç—Ñ—Ñ–µ–∫—Ç–∞ {"damage": 5}
```

### 2. TRIGGER_RULES (Runtime)
–û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —Å–ª–æ–≤–∞—Ä—å –¥–ª—è `CombatResolver`. –ì—Ä—É–ø–ø–∏—Ä—É–µ—Ç —Ç—Ä–∏–≥–≥–µ—Ä—ã –ø–æ —Å–æ–±—ã—Ç–∏—è–º.

```python
TRIGGER_RULES = {
    "ON_CRIT": {
        "trigger_bleed": {
            "chance": 1.0,
            "mutations": {"crit_damage_boost": False} # –û—Ç–∫–ª—é—á–∞–µ—Ç x2 —É—Ä–æ–Ω
        }
    }
}
```

---

## üîÑ –ü—Ä–æ—Ü–µ—Å—Å –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –Ω–æ–≤–æ–≥–æ —Ç—Ä–∏–≥–≥–µ—Ä–∞

1.  **–û–ø—Ä–µ–¥–µ–ª–∏—Ç—å:** –î–æ–±–∞–≤–∏—Ç—å –∑–∞–ø–∏—Å—å –≤ `definitions/weapon_triggers.py`.
2.  **–ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å:** –£–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ –æ–Ω –ø–æ–ø–∞–ª –≤ `TRIGGER_REGISTRY`.
3.  **–ù–∞—Å—Ç—Ä–æ–∏—Ç—å –ø—Ä–∞–≤–∏–ª–æ:** –ï—Å–ª–∏ —Ç—Ä–∏–≥–≥–µ—Ä –º–µ–Ω—è–µ—Ç –ª–æ–≥–∏–∫—É –±–æ—è (–Ω–∞–ø—Ä–∏–º–µ—Ä, –æ—Ç–º–µ–Ω—è–µ—Ç –∫—Ä–∏—Ç), –¥–æ–±–∞–≤–∏—Ç—å –ø—Ä–∞–≤–∏–ª–æ –≤ `TRIGGER_RULES`.
4.  **–†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å —ç—Ñ—Ñ–µ–∫—Ç:** –ï—Å–ª–∏ —Ç—Ä–∏–≥–≥–µ—Ä –Ω–∞–∫–ª–∞–¥—ã–≤–∞–µ—Ç —ç—Ñ—Ñ–µ–∫—Ç, –¥–æ–±–∞–≤–∏—Ç—å –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ –≤ `AbilityService.apply_trigger_effect`.
