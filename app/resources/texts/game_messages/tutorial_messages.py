# app/resources/texts/game_messages/tutorial_messages.py
from typing import Dict, List, Any, Tuple, Union

# --- –¢–∏–ø—ã –¥–∞–Ω–Ω—ã—Ö ---
StatPayload = Dict[str, int]
ButtonData = Dict[str, str]
QuestStepData = Dict[str, Union[str, ButtonData]]


class TutorialEventsData:
    """
    –≠—Ç–æ—Ç –∫–ª–∞—Å—Å —Ö—Ä–∞–Ω–∏—Ç –ü–£–õ —Å–æ–±—ã—Ç–∏–π –∏ –õ–û–ì–ò–ö–£ –¥–ª—è FSM —Ç—É—Ç–æ—Ä–∏–∞–ª–∞.
    """

    # –®–∞–±–ª–æ–Ω –¥–ª—è —Ö—ç–Ω–¥–ª–µ—Ä–∞ FSM, –∫–æ—Ç–æ—Ä—ã–π –±—É–¥–µ—Ç —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞—Ç—å —Ç–µ–∫—Å—Ç
    SIMULATION_TEXT_TEMPLATE: str = """<b>[–°–ò–ú–£–õ–Ø–¶–ò–Ø {number}/4]:</b> ...–ó–∞–≥—Ä—É–∑–∫–∞...

{text_event}"""

    # ---
    # –ü–£–õ –°–û–ë–´–¢–ò–ô (–û—á–∏—â–µ–Ω –æ—Ç –∑–∞–≥–æ–ª–æ–≤–∫–æ–≤)
    # ---
    TUTORIAL_EVENT_POOL: List[QuestStepData] = [

        # --- –°–æ–±—ã—Ç–∏–µ 1: "–ü—Ä–µ–ø—è—Ç—Å—Ç–≤–∏–µ" ---
        {
            "text": """–¢—ã –≤ —Ç–µ–º–Ω–æ–º –∫–æ—Ä–∏–¥–æ—Ä–µ. –í–ø–µ—Ä–µ–¥–∏ - –∑–∞–≤–∞–ª. –í–∏–¥–Ω—ã –¥–≤–∞ –ø—É—Ç–∏: —É–∑–∫–∞—è, —Ç–µ–º–Ω–∞—è —Ç—Ä—É–±–∞ –≤–Ω–∏–∑—É –∏ —à–∞—Ç–∫–∏–π —É—Å—Ç—É–ø, –≤–µ–¥—É—â–∏–π –Ω–∞–≤–µ—Ä—Ö.

–¢–≤–æ—è –∏–Ω—Å—Ç–∏–Ω–∫—Ç–∏–≤–Ω–∞—è —Ä–µ–∞–∫—Ü–∏—è?""",
            "buttons": {
                "tut_ev1:might": """‚öîÔ∏è "–†–∞–∑–æ–±—Ä–∞—Ç—å –∫–∞–º–Ω–∏ –≤—Ä—É—á–Ω—É—é." """,
                "tut_ev1:finesse": """ü§∏ "–õ–µ–∑—Ç—å –Ω–∞ —É—Å—Ç—É–ø. –ë—ã—Å—Ç—Ä–æ." """,
                "tut_ev1:wits": """üß† "–ò—Å–∫–∞—Ç—å —Ä—ã—á–∞–≥ –∏–ª–∏ –º–µ—Ö–∞–Ω–∏–∑–º." """
            }
        },

        # --- –°–æ–±—ã—Ç–∏–µ 2: "–°—Ç–æ–ª–∫–Ω–æ–≤–µ–Ω–∏–µ" ---
        {
            "text": """–ò–∑-–∑–∞ —É–≥–ª–∞ –¥–æ–Ω–æ—Å–∏—Ç—Å—è —Ä—ã—á–∞–Ω–∏–µ. –ú–∞–ª–µ–Ω—å–∫–æ–µ, –∏–∑—Ä–∞–Ω–µ–Ω–Ω–æ–µ —Å—É—â–µ—Å—Ç–≤–æ —Å–∫–∞–ª–∏—Ç –∑—É–±—ã. –û–Ω–æ —è–≤–Ω–æ –∑–∞—â–∏—â–∞–µ—Ç —á—Ç–æ-—Ç–æ –≤ —É–≥–ª—É.

–¢–≤–æ—è –∏–Ω—Å—Ç–∏–Ω–∫—Ç–∏–≤–Ω–∞—è —Ä–µ–∞–∫—Ü–∏—è?""",
            "buttons": {
                "tut_ev2:might": """‚öîÔ∏è "–£–≥—Ä–æ–∑–∞. –ù–µ–π—Ç—Ä–∞–ª–∏–∑–æ–≤–∞—Ç—å." """,
                "tut_ev2:social": """ü§ù "–û–Ω–æ —Ä–∞–Ω–µ–Ω–æ. –ü–æ–ø—ã—Ç–∞—Ç—å—Å—è –ø—Ä–∏–º–∞–Ω–∏—Ç—å –µ–¥–æ–π." """,
                "tut_ev2:finesse": """ü§∏ "–¢–∏—Ö–æ. –û–±–æ–π—Ç–∏, –Ω–µ –ø—Ä–∏–≤–ª–µ–∫–∞—è –≤–Ω–∏–º–∞–Ω–∏—è." """
            }
        },

        # --- –°–æ–±—ã—Ç–∏–µ 3: "–ù–∞—Ö–æ–¥–∫–∞" ---
        {
            "text": """–¢—ã –∑–∞–º–µ—á–∞–µ—à—å –≤ —Ç–µ–º–Ω–æ–º —É–≥–ª—É —Ä–∂–∞–≤—ã–π, –Ω–æ –∫—Ä–µ–ø–∫–∏–π —Å—É–Ω–¥—É–∫. –û–Ω –∑–∞–ø–µ—Ä—Ç.

–¢–≤–æ—è –∏–Ω—Å—Ç–∏–Ω–∫—Ç–∏–≤–Ω–∞—è —Ä–µ–∞–∫—Ü–∏—è?""",
            "buttons": {
                "tut_ev3:might": """‚öîÔ∏è "–£–¥–∞—Ä–∏—Ç—å –Ω–æ–≥–æ–π. –°–∏–ª–æ–π." """,
                "tut_ev3:finesse": """ü§∏ "–ü–æ–ø—ã—Ç–∞—Ç—å—Å—è –≤—Å–∫—Ä—ã—Ç—å –∑–∞–º–æ–∫." """,
                "tut_ev3:wits": """üß† "–õ–æ–≤—É—à–∫–∞. –û—Å—Ç–∞–≤–∏—Ç—å –µ–≥–æ –≤ –ø–æ–∫–æ–µ." """
            }
        },

        # --- –°–æ–±—ã—Ç–∏–µ 4: "–î–∏–ª–µ–º–º–∞" ---
        {
            "text": """–î—Ä—É–≥–æ–π '–ü—Ä–æ—à–µ–¥—à–∏–π' —Ä–∞–Ω–µ–Ω. –û–Ω –ø—Ä–æ—Å–∏—Ç —Ç–µ–±—è –æ—Ç–Ω–µ—Å—Ç–∏ –µ–≥–æ –ø—Ä–∏–ø–∞—Å—ã –≤ –ª–∞–≥–µ—Ä—å, –ø–æ–∫–∞ –Ω–∞ –Ω–µ–≥–æ –æ—Ö–æ—Ç—è—Ç—Å—è. –≠—Ç–æ –∑–∞–º–µ–¥–ª–∏—Ç —Ç–µ–±—è.

–¢–≤–æ—è –∏–Ω—Å—Ç–∏–Ω–∫—Ç–∏–≤–Ω–∞—è —Ä–µ–∞–∫—Ü–∏—è?""",
            "buttons": {
                "tut_ev4:social": """ü§ù "–Ø –ø–æ–º–æ–≥—É. –ú—ã —Å–≤–æ–∏—Ö –Ω–µ –±—Ä–æ—Å–∞–µ–º." """,
                "tut_ev4:wits": """üß† "–Ø –≤–æ–∑—å–º—É —á–∞—Å—Ç—å. –ù–æ –≤–∑–∞–º–µ–Ω..." """,
                "tut_ev4:action": """‚öîÔ∏è "–í—ã–∂–∏–≤–∞–µ—Ç —Å–∏–ª—å–Ω–µ–π—à–∏–π. –ú–Ω–µ –∂–∞–ª—å." """
            }
        }

        # (–ö–æ–≥–¥–∞ –ª–æ—Ä-–º–∞—Å—Ç–µ—Ä –Ω–∞–ø–∏—à–µ—Ç –µ—â–µ 16 —Å–æ–±—ã—Ç–∏–π, –æ–Ω–∏ –ª—è–≥—É—Ç —Å—é–¥–∞)

    ]  # –ö–æ–Ω–µ—Ü TUTORIAL_EVENT_POOL

    # ---
    # –ü–£–õ –õ–û–ì–ò–ö–ò (–¥–ª—è –≤—Å–µ—Ö 20+ –∏–≤–µ–Ω—Ç–æ–≤)
    # ---
    TUTORIAL_LOGIC_POOL: Dict[str, StatPayload] = {
        # Event 1
        "tut_ev1:might": {"strength": 1, "endurance": 1},
        "tut_ev1:finesse": {"dexterity": 1, "perception": 1},
        "tut_ev1:wits": {"intelligence": 1, "perception": 1},

        # Event 2
        "tut_ev2:might": {"strength": 1, "dexterity": 1},
        "tut_ev2:social": {"charisma": 1, "intelligence": 1},
        "tut_ev2:finesse": {"dexterity": 1, "perception": 1},

        # Event 3
        "tut_ev3:might": {"strength": 1, "endurance": 1},
        "tut_ev3:finesse": {"dexterity": 1, "intelligence": 1},
        "tut_ev3:wits": {"perception": 1, "endurance": 1},

        # Event 4
        "tut_ev4:social": {"charisma": 1, "endurance": 1},
        "tut_ev4:wits": {"intelligence": 1, "charisma": 1},
        "tut_ev4:action": {"strength": 1, "perception": 1},

        # (–ö–æ–≥–¥–∞ –ª–æ—Ä-–º–∞—Å—Ç–µ—Ä –Ω–∞–ø–∏—à–µ—Ç –µ—â–µ 16 —Å–æ–±—ã—Ç–∏–π, –∏—Ö –ª–æ–≥–∏–∫–∞ –ª—è–∂–µ—Ç —Å—é–¥–∞)
    }


class TutorialMessages:
    """
    –¢–µ–∫—Å—Ç—ã –∏ –º–µ—Ç–∞-–¥–∞–Ω–Ω—ã–µ –¥–ª—è —Ç—É—Ç–æ—Ä–∏–∞–ª–∞ "–î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –Ø–∫–æ—Ä—è".
    v6: –ü—É–ª —Å–æ–±—ã—Ç–∏–π –∏ –ª–æ–≥–∏–∫–∞ –≤—ã–Ω–µ—Å–µ–Ω—ã –≤ 'TutorialEventsData'
    """

    # --- –°—Ü–µ–Ω–∞ 1: –ü—Ä–æ–±—É–∂–¥–µ–Ω–∏–µ (–°–±–æ–π) ---
    WAKING_UP_SEQUENCE: Tuple[tuple[str, int], ...] = (
        ("""<i>...–∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è... —Å–±–æ–π... –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è –æ—à–∏–±–∫–∞...</i>""", 2),
        ("""<b>[–°–ò–°–¢–ï–ú–ê]:</b> ...–ü–æ–ø—ã—Ç–∫–∞ #2... –û–±–Ω–∞—Ä—É–∂–µ–Ω–∞ —á—É–∂–µ—Ä–æ–¥–Ω–∞—è –±–∏–æ-—Å–∏–≥–Ω–∞—Ç—É—Ä–∞...""", 2),
        ("""<b>[–°–ò–°–¢–ï–ú–ê]:</b> –ü—Ä–æ—Ç–æ–∫–æ–ª '–Ø–∫–æ—Ä—å' –ø–æ–≤—Ä–µ–∂–¥–µ–Ω. –ó–∞–ø—É—Å–∫ —Ä—É—á–Ω–æ–π –∫–∞–ª–∏–±—Ä–æ–≤–∫–∏...""", 2)
    )

    # --- –°—Ü–µ–Ω–∞ 2: –ó–∞–ø—É—Å–∫ FSM ---
    TUTORIAL_PROMPT_TEXT: str = """<b>[–°–ò–°–¢–ï–ú–ê]:</b> –¢—ã —Å–ª—ã—à–∏—à—å –º–µ–Ω—è, '–ü—Ä–æ—à–µ–¥—à–∏–π'? –¢–≤–æ–π –ø—Ä–æ—Ñ–∏–ª—å –Ω–µ—Å—Ç–∞–±–∏–ª–µ–Ω.

–Ø –∑–∞–ø—É—â—É 4 –∫–æ—Ä–æ—Ç–∫–∏—Ö —Å–∏–º—É–ª—è—Ü–∏–∏, –æ—Å–Ω–æ–≤–∞–Ω–Ω—ã—Ö –Ω–∞ —Ç–≤–æ–∏—Ö –æ—Å—Ç–∞—Ç–æ—á–Ω—ã—Ö —ç—Ö–æ-–≤–æ—Å–ø–æ–º–∏–Ω–∞–Ω–∏—è—Ö. –¢–≤–æ—è —Ä–µ–∞–∫—Ü–∏—è –ø–æ–∑–≤–æ–ª–∏—Ç –º–Ω–µ –æ—Ç–∫–∞–ª–∏–±—Ä–æ–≤–∞—Ç—å —Ç–≤–æ–π —è–∫–æ—Ä—å.

–ü–æ–¥—Ç–≤–µ—Ä–¥–∏ –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç—å –∫ –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–µ."""

    TUTORIAL_START_BUTTON: ButtonData = {
        "tut:start": """[ üß† ] "–Ø –≥–æ—Ç–æ–≤. –ù–∞—á–∏–Ω–∞–π." """
    }

    TUTORIAL_ANALYSIS_TEXT: Tuple[tuple[str, int], ...] = (
        ("""<b>[–°–ò–°–¢–ï–ú–ê]:</b> ...–ü—Ä–∏—ë–º –æ—Ç–≤–µ—Ç–æ–≤ –∑–∞–≤–µ—Ä—à–µ–Ω...""", 2),
        ("""<b>[–°–ò–°–¢–ï–ú–ê]:</b> ...–ê–Ω–∞–ª–∏–∑ —ç—Ö–æ-—Å–∏–≥–Ω–∞—Ç—É—Ä... 
            <pre>...[7%]...[34%]...[61%]...</pre>""", 3),
        ("""<b>[–°–ò–°–¢–ï–ú–ê]:</b> ...[99%]... –û–±–Ω–∞—Ä—É–∂–µ–Ω–∞ –∫–æ—Ä—Ä–µ–ª—è—Ü–∏—è. 
            ...–í—ã—Ä–∞–≤–Ω–∏–≤–∞–Ω–∏–µ '–Ø–∫–æ—Ä—è' –ø–æ –±–∞–∑–æ–≤—ã–º –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º...""", 2)
    )

    TUTORIAL_ANALYSIS_BUTTON: ButtonData = {
        "tut:continue" : """ ‚è≠Ô∏è –ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å. """
    }

    TUTORIAL_COMPLETE_TEXT: str = """...–ö–∞–ª–∏–±—Ä–æ–≤–∫–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∞...

<b>[–°–ò–°–¢–ï–ú–ê]:</b> '–Ø–∫–æ—Ä—å' —Å—Ç–∞–±–∏–ª–∏–∑–∏—Ä–æ–≤–∞–Ω. –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è —Å —ç—Ö–æ-–≤–æ—Å–ø–æ–º–∏–Ω–∞–Ω–∏—è–º–∏ –ø—Ä–æ—à–ª–∞ —É—Å–ø–µ—à–Ω–æ.

–¢–≤–æ–∏ —Å—Ç–∞—Ä—Ç–æ–≤—ã–µ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏ –∑–∞—Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω—ã:
<b>–°–∏–ª–∞:</b> {strength}
<b>–í–æ—Å–ø—Ä–∏—è—Ç–∏–µ:</b> {perception}
<b>–í—ã–Ω–æ—Å–ª–∏–≤–æ—Å—Ç—å:</b> {endurance}
<b>–•–∞—Ä–∏–∑–º–∞:</b> {charisma}
<b>–ò–Ω—Ç–µ–ª–ª–µ–∫—Ç:</b> {intelligence}
<b>–õ–æ–≤–∫–æ—Å—Ç—å:</b> {dexterity}
"""

    TUTORIAL_CONFIRM_PROMPT: str = """<b>[–°–ò–°–¢–ï–ú–ê]:</b> –ö–∞–ª–∏–±—Ä–æ–≤–∫–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∞. –¢–≤–æ–π '–Ø–∫–æ—Ä—å' —Å—Ç–∞–±–∏–ª–µ–Ω.

–¢–≤–æ–π –ø—É—Ç—å –Ω–∞—á–∏–Ω–∞–µ—Ç—Å—è —Å–µ–π—á–∞—Å, '–ü—Ä–æ—à–µ–¥—à–∏–π'."""

    TUTORIAL_CONFIRM_BUTTONS: ButtonData = {
        "tut:finish": """‚úÖ –û—Ç–ª–∏—á–Ω–æ. –ß—Ç–æ –¥–∞–ª—å—à–µ?""",
        "tut:restart": """‚ùì –ù–µ –ø–æ–Ω—è–ª. –ü–æ–≤—Ç–æ—Ä–∏—Ç—å –∫–∞–ª–∏–±—Ä–æ–≤–∫—É."""
    }