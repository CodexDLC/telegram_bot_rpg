name: CI Code Quality

on:
  # –≠—Ç–∏ —Å–æ–±—ã—Ç–∏—è –∞–∫—Ç–∏–≤–∏—Ä—É—é—Ç –í–ï–°–¨ Workflow:
  push:
    branches: [ "main", "develop", "devops" ]
  pull_request:
    branches: ["main"]


jobs:
  # --- –ü–û–¢–û–ö 1: –õ–∏–Ω—Ç–µ—Ä (–°—Ç–∏–ª—å –∏ —Å–∏–Ω—Ç–∞–∫—Å–∏—Å) ---
  lint:
    name: ‚ö° Ruff Linter
    runs-on: ubuntu-latest
    # –£—Å–ª–æ–≤–∏–µ: –ù–µ –Ω—É–∂–Ω–æ, –æ–Ω –±—É–¥–µ—Ç –∑–∞–ø—É—Å–∫–∞—Ç—å—Å—è –ø–æ –æ–±–æ–∏–º —Å–æ–±—ã—Ç–∏—è–º,
    # –Ω–æ Ruff –±—ã—Å—Ç—Ä—ã–π, –ø–æ—ç—Ç–æ–º—É –æ—Å—Ç–∞–≤–ª—è–µ–º –µ–≥–æ –Ω–∞ push/pr.
    steps:
      - name: Checkout code
        uses: actions/checkout@v4
      - name: Set up Python 3.13
        uses: actions/setup-python@v5
        with:
          python-version: "3.13"
          cache: "pip"
      - name: Install dependencies
        run: |
          python -m pip install --upgrade pip
          pip install -r requirements-dev.txt
      - name: Run Ruff (Linter)
        run: ruff check .
      - name: Run Ruff (Formatter check)
        run: ruff format --check .

  # --- –ü–û–¢–û–ö 2: –¢–∏–ø–∏–∑–∞—Ü–∏—è (–°—Ç—Ä–æ–≥–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ —Ç–∏–ø–æ–≤) ---
  type-check:
    name: üõ°Ô∏è Mypy Static Analysis
    runs-on: ubuntu-latest
    # üî• –£–°–õ–û–í–ò–ï: –ó–∞–ø—É—Å–∫–∞–µ–º –¢–û–õ–¨–ö–û, –µ—Å–ª–∏ —Å–æ–±—ã—Ç–∏–µ —Ä–∞–≤–Ω–æ 'pull_request'.
    # –≠—Ç–æ –æ—Ç–∫–ª—é—á–∏—Ç Mypy –ø—Ä–∏ –æ–±—ã—á–Ω–æ–º 'push' –≤ –≤–µ—Ç–∫—É —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏.
    if: github.event_name == 'pull_request'
    steps:
      - name: Checkout code
        uses: actions/checkout@v4
      - name: Set up Python 3.13
        uses: actions/setup-python@v5
        with:
          python-version: "3.13"
          cache: "pip"
      - name: Install dependencies
        run: |
          python -m pip install --upgrade pip
          pip install -r requirements-dev.txt
      - name: Run Mypy
        run: mypy .

  # --- (–ù–ê –ë–£–î–£–©–ï–ï) –ü–û–¢–û–ö 3: –¢–µ—Å—Ç—ã ---
  # tests:
  #   name: üß™ Pytest
  #   runs-on: ubuntu-latest
  #   needs: [lint, type-check]
  #   if: github.event_name == 'pull_request' # ‚¨ÖÔ∏è –¢–æ–∂–µ —Ç–æ–ª—å–∫–æ –ø—Ä–∏ PR
  #   steps:
  #     ...